<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Control Panel - Realm</title>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Professional Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Chart.js for graphs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

    <!-- Socket.io for real-time updates -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

    <style>
        /* Color Palette - Consistent with Student/Alumni */
        :root {
            --primary-dark: #13293D;
            --primary-blue: #006494;
            --accent-blue: #247BA0;
            --bright-blue: #1B98E0;
            --light-bg: #E8F1F2;

            --white: #FFFFFF;
            --gray-50: #F8FAFC;
            --gray-100: #F1F5F9;
            --gray-200: #E2E8F0;
            --gray-300: #CBD5E1;
            --gray-400: #94A3B8;
            --gray-500: #64748B;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1E293B;
            --gray-900: #0F172A;

            --success: #10B981;
            --error: #EF4444;
            --warning: #F59E0B;
            --info: #3B82F6;

            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);

            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;

            --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            height: 100vh;
            overflow-x: hidden;
        }

        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--light-bg);
            color: var(--gray-700);
            line-height: 1.5;
        }

        /* Header */
        .header {
            background: var(--white);
            border-bottom: 1px solid var(--gray-200);
            padding: 0 20px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-sm);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        .logo {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.6rem;
            font-weight: 700;
            letter-spacing: 0.1em;
        }

        .logo .realm-first {
            color: #1B98E0;
        }

        .logo .realm-second {
            color: var(--primary-dark);
        }

        .admin-badge {
            background: linear-gradient(135deg, var(--error), #dc2626);
            color: var(--white);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .search-container {
            position: relative;
            width: 400px;
        }

        .search-input {
            width: 100%;
            padding: 10px 15px 10px 45px;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            font-size: 0.9rem;
            background: var(--gray-50);
            transition: var(--transition);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            background: var(--white);
            box-shadow: 0 0 0 3px rgba(36, 123, 160, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-400);
            font-size: 1rem;
        }

        .search-btn {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, var(--accent-blue), var(--bright-blue));
            color: var(--white);
            border: none;
            padding: 8px 16px;
            border-radius: var(--radius-md);
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .search-btn:hover {
            transform: translateY(-50%) translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .notification-btn {
            position: relative;
            background: none;
            border: none;
            color: var(--gray-600);
            font-size: 1.1rem;
            cursor: pointer;
            padding: 10px;
            border-radius: var(--radius-md);
            transition: var(--transition);
        }

        .notification-btn:hover {
            background: var(--gray-100);
            color: var(--gray-900);
        }

        .notification-badge {
            position: absolute;
            top: 6px;
            right: 6px;
            background: var(--error);
            color: var(--white);
            font-size: 0.7rem;
            padding: 2px 5px;
            border-radius: 10px;
            min-width: 16px;
            text-align: center;
        }

        .profile-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--error), #dc2626);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

        .profile-avatar:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }

        /* Admin Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 70px;
            width: 260px;
            height: calc(100vh - 70px);
            background: var(--white);
            border-right: 1px solid var(--gray-200);
            padding: 20px 0;
            overflow-y: auto;
            z-index: 50;
            transition: var(--transition);
        }

        .sidebar-section {
            margin-bottom: 25px;
        }

        .sidebar-title {
            padding: 0 20px 10px;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: var(--gray-600);
            text-decoration: none;
            transition: var(--transition);
            border-left: 3px solid transparent;
            position: relative;
            cursor: pointer;
        }

        .sidebar-item:hover {
            background: var(--gray-50);
            color: var(--gray-900);
        }

        .sidebar-item.active {
            background: rgba(36, 123, 160, 0.1);
            color: var(--accent-blue);
            border-left-color: var(--accent-blue);
        }

        .sidebar-item i {
            font-size: 1.1rem;
            width: 22px;
            text-align: center;
        }

        .sidebar-text {
            font-size: 0.9rem;
            font-weight: 500;
        }

        .sidebar-count {
            margin-left: auto;
            background: var(--error);
            color: var(--white);
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }

        .sidebar-count.success {
            background: var(--success);
        }

        .sidebar-count.warning {
            background: var(--warning);
        }

        .sidebar-count.info {
            background: var(--info);
        }

        /* Main Content */
        .main-content {
            margin-left: 260px;
            padding: 25px;
            min-height: calc(100vh - 70px);
            transition: var(--transition);
        }

        .page-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 600;
            color: var(--gray-900);
        }

        .page-actions {
            display: flex;
            gap: 12px;
        }

        /* Stats Overview */
        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: 25px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, var(--accent-blue), var(--bright-blue));
        }

        .stat-card.success::before {
            background: linear-gradient(135deg, var(--success), #059669);
        }

        .stat-card.warning::before {
            background: linear-gradient(135deg, var(--warning), #d97706);
        }

        .stat-card.info::before {
            background: linear-gradient(135deg, var(--info), #2563eb);
        }

        .stat-card.danger::before {
            background: linear-gradient(135deg, var(--error), #dc2626);
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: var(--white);
            background: linear-gradient(135deg, var(--accent-blue), var(--bright-blue));
        }

        .stat-icon.success {
            background: linear-gradient(135deg, var(--success), #059669);
        }

        .stat-icon.warning {
            background: linear-gradient(135deg, var(--warning), #d97706);
        }

        .stat-icon.info {
            background: linear-gradient(135deg, var(--info), #2563eb);
        }

        .stat-icon.danger {
            background: linear-gradient(135deg, var(--error), #dc2626);
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--gray-600);
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
        }

        .stat-trend.positive {
            color: var(--success);
        }

        .stat-trend.negative {
            color: var(--error);
        }

        .stat-trend.neutral {
            color: var(--gray-500);
        }

        /* Content Sections */
        .content-section {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray-200);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--gray-900);
        }

        .section-actions {
            display: flex;
            gap: 10px;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .data-table th,
        .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--gray-200);
        }

        .data-table th {
            background: var(--gray-50);
            font-weight: 600;
            color: var(--gray-700);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .data-table tr:hover {
            background: var(--gray-50);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
        }

        .status-badge.verified {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status-badge.pending {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .status-badge.rejected {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }

        .status-badge.active {
            background: rgba(59, 130, 246, 0.1);
            color: var(--info);
        }

        .status-badge.published {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status-badge.resolved {
            background: rgba(59, 130, 246, 0.1);
            color: var(--info);
        }

        .status-badge.cancelled {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-blue), var(--bright-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Buttons */
        .btn-primary,
        .btn-secondary,
        .btn-success,
        .btn-danger,
        .btn-warning {
            padding: 8px 16px;
            border-radius: var(--radius-md);
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-blue), var(--bright-blue));
            color: var(--white);
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--gray-100);
            color: var(--gray-700);
            border: 2px solid var(--gray-200);
        }

        .btn-secondary:hover {
            background: var(--gray-200);
            border-color: var(--gray-300);
        }

        .btn-success {
            background: var(--success);
            color: var(--white);
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: var(--error);
            color: var(--white);
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--white);
        }

        .btn-warning:hover {
            background: #d97706;
        }

        .btn-sm {
            padding: 4px 8px;
            font-size: 0.75rem;
        }

        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(8px);
        }

        .modal-overlay.hidden {
            display: none;
        }

        .modal-content {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: 30px;
            width: 90vw;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            position: relative;
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray-200);
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--gray-900);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--gray-400);
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--gray-700);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--gray-700);
            margin-bottom: 5px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            background: var(--white);
            color: var(--gray-700);
            transition: var(--transition);
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(36, 123, 160, 0.1);
        }

        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }

        /* Profile Dropdown */
        .profile-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            min-width: 220px;
            z-index: 200;
            margin-top: 8px;
            overflow: hidden;
            display: none;
        }

        .profile-dropdown.show {
            display: block;
        }

        .dropdown-header {
            padding: 18px;
            border-bottom: 1px solid var(--gray-200);
            background: var(--gray-50);
        }

        .dropdown-name {
            font-weight: 600;
            color: var(--gray-900);
            font-size: 0.95rem;
            margin-bottom: 2px;
        }

        .dropdown-email {
            color: var(--gray-600);
            font-size: 0.8rem;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 18px;
            color: var(--gray-700);
            text-decoration: none;
            transition: var(--transition);
            cursor: pointer;
        }

        .dropdown-item:hover {
            background: var(--gray-50);
            color: var(--gray-900);
        }

        .dropdown-item i {
            font-size: 1rem;
            width: 18px;
            text-align: center;
        }

        .dropdown-divider {
            height: 1px;
            background: var(--gray-200);
            margin: 8px 0;
        }

        /* Verification Cards */
        .verification-card {
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 20px;
            background: var(--white);
            transition: var(--transition);
        }

        .verification-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }

        /* Chart Container */
        .chart-container {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            height: 400px;
            position: relative;
        }

        .chart-canvas {
            width: 100% !important;
            height: 300px !important;
        }

        /* Settings Cards */
        .settings-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
        }

        .settings-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid var(--gray-100);
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: var(--gray-300);
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
        }

        .toggle-switch.active {
            background: var(--success);
        }

        .toggle-switch::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--white);
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: var(--transition);
        }

        .toggle-switch.active::before {
            transform: translateX(26px);
        }

        /* Search Results */
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            max-height: 300px;
            overflow-y: auto;
            z-index: 200;
            display: none;
        }

        .search-result-item {
            padding: 12px 15px;
            border-bottom: 1px solid var(--gray-100);
            cursor: pointer;
            transition: var(--transition);
        }

        .search-result-item:hover {
            background: var(--gray-50);
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .search-result-type {
            font-size: 0.75rem;
            color: var(--accent-blue);
            font-weight: 600;
            text-transform: uppercase;
        }

        .search-result-title {
            font-weight: 500;
            color: var(--gray-900);
            margin: 2px 0;
        }

        .search-result-desc {
            font-size: 0.85rem;
            color: var(--gray-600);
        }

        /* Report Cards */
        .report-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            cursor: pointer;
            transition: var(--transition);
        }

        .report-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .report-icon {
            width: 50px;
            height: 50px;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--white);
            margin-bottom: 15px;
        }

        /* Notifications Panel */
        .notification-panel {
            position: fixed;
            top: 70px;
            right: 20px;
            width: 300px;
            max-height: 400px;
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            z-index: 300;
            display: none;
            overflow: hidden;
        }

        .notification-panel.show {
            display: block;
        }

        .notification-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--gray-200);
            background: var(--gray-50);
        }

        .notification-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .notification-item {
            padding: 15px 20px;
            border-bottom: 1px solid var(--gray-100);
            cursor: pointer;
            transition: var(--transition);
        }

        .notification-item:hover {
            background: var(--gray-50);
        }

        .notification-item.unread {
            background: rgba(59, 130, 246, 0.05);
            border-left: 3px solid var(--info);
        }

        .notification-title {
            font-weight: 500;
            color: var(--gray-900);
            margin-bottom: 2px;
        }

        .notification-text {
            font-size: 0.85rem;
            color: var(--gray-600);
            margin-bottom: 5px;
        }

        .notification-time {
            font-size: 0.75rem;
            color: var(--gray-500);
        }

        /* Filter Panel */
        .filter-panel {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            display: none;
        }

        .filter-panel.show {
            display: block;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .search-container {
                width: 250px;
            }

            .stats-overview {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                width: 260px;
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 15px;
            }

            .search-container {
                width: 200px;
            }

            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .stats-overview {
                grid-template-columns: 1fr;
            }

            .chart-container {
                height: 300px;
            }
        }

        /* Focus and accessibility */
        *:focus-visible {
            outline: 2px solid var(--accent-blue);
            outline-offset: 2px;
        }

        /* Hidden class for view switching */
        .view-content {
            display: none;
        }

        .view-content.active {
            display: block;
        }

        /* Loading states */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--gray-300);
            border-top: 2px solid var(--accent-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* Connection Status */
        .connection-status {
            position: fixed;
            bottom: 20px;
            left: 20px;
            padding: 8px 12px;
            border-radius: var(--radius-md);
            font-size: 0.8rem;
            font-weight: 500;
            z-index: 1000;
            display: none;
        }

        .connection-status.online {
            background: var(--success);
            color: var(--white);
        }

        .connection-status.offline {
            background: var(--error);
            color: var(--white);
        }
    </style>
</head>

<body>
    <!-- Connection Status -->
    <div class="connection-status" id="connectionStatus">
        <i class="fas fa-wifi"></i>
        <span>Connected</span>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="logo">
                <span class="realm-first">REA</span><span class="realm-second">LM</span>
            </div>
            <div class="admin-badge">Admin</div>

            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" placeholder="Search users, events, articles..."
                    id="globalSearch" autocomplete="off">
                <button class="search-btn" id="searchBtn">Search</button>
                <div class="search-results" id="searchResults"></div>
            </div>
        </div>

        <div class="header-right">
            <button class="notification-btn" id="notificationBtn" title="System Alerts">
                <i class="fas fa-bell"></i>
                <span class="notification-badge" id="notificationBadge">0</span>
            </button>

            <div class="profile-avatar" id="profileAvatar">
                <span id="avatarInitials">AD</span>

                <!-- Profile Dropdown -->
                <div class="profile-dropdown" id="profileDropdown">
                    <div class="dropdown-header">
                        <div class="dropdown-name" id="dropdownName">Admin User</div>
                        <div class="dropdown-email" id="dropdownEmail">admin@realm.com</div>
                    </div>

                    <div class="dropdown-item" onclick="adminDashboard.openProfileSettings()">
                        <i class="fas fa-user-shield"></i>
                        <span>Admin Profile</span>
                    </div>

                    <div class="dropdown-item" onclick="adminDashboard.switchView('settings')">
                        <i class="fas fa-cogs"></i>
                        <span>System Settings</span>
                    </div>

                    <div class="dropdown-divider"></div>

                    <div class="dropdown-item" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Notification Panel -->
    <div class="notification-panel" id="notificationPanel">
        <div class="notification-header">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h3 style="font-size: 1rem; font-weight: 600;">Notifications</h3>
                <button class="btn-secondary btn-sm" onclick="adminDashboard.markAllNotificationsRead()">
                    Mark All Read
                </button>
            </div>
        </div>
        <div class="notification-list" id="notificationList">
            <!-- Notifications will be populated here -->
        </div>
    </div>

    <!-- Admin Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-section">
            <div class="sidebar-title">Overview</div>
            <div class="sidebar-item active" data-view="dashboard">
                <i class="fas fa-tachometer-alt"></i>
                <span class="sidebar-text">Dashboard</span>
            </div>
            <div class="sidebar-item" data-view="analytics">
                <i class="fas fa-chart-line"></i>
                <span class="sidebar-text">Analytics</span>
            </div>
        </div>

        <div class="sidebar-section">
            <div class="sidebar-title">User Management</div>
            <div class="sidebar-item" data-view="students">
                <i class="fas fa-user-graduate"></i>
                <span class="sidebar-text">Students</span>
                <span class="sidebar-count info" id="studentsCount">0</span>
            </div>
            <div class="sidebar-item" data-view="alumni">
                <i class="fas fa-users"></i>
                <span class="sidebar-text">Alumni</span>
                <span class="sidebar-count success" id="alumniCount">0</span>
            </div>
            <div class="sidebar-item" data-view="verifications">
                <i class="fas fa-user-check"></i>
                <span class="sidebar-text">Verifications</span>
                <span class="sidebar-count warning" id="verificationCount">0</span>
            </div>
        </div>

        <div class="sidebar-section">
            <div class="sidebar-title">Content Management</div>
            <div class="sidebar-item" data-view="events">
                <i class="fas fa-calendar"></i>
                <span class="sidebar-text">Events</span>
                <span class="sidebar-count" id="eventsCount">0</span>
            </div>
            <div class="sidebar-item" data-view="articles">
                <i class="fas fa-newspaper"></i>
                <span class="sidebar-text">Articles</span>
                <span class="sidebar-count" id="articlesCount">0</span>
            </div>
            <div class="sidebar-item" data-view="questions">
                <i class="fas fa-question-circle"></i>
                <span class="sidebar-text">Q&A Board</span>
                <span class="sidebar-count" id="questionsCount">0</span>
            </div>
        </div>

        <div class="sidebar-section">
            <div class="sidebar-title">System</div>
            <div class="sidebar-item" data-view="reports">
                <i class="fas fa-file-alt"></i>
                <span class="sidebar-text">Reports</span>
            </div>
            <div class="sidebar-item" data-view="settings">
                <i class="fas fa-cog"></i>
                <span class="sidebar-text">Settings</span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Dashboard View -->
        <div class="view-content active" id="dashboardView">
            <div class="page-header">
                <h1 class="page-title">Admin Dashboard</h1>
                <div class="page-actions">
                    <button class="btn-secondary" onclick="adminDashboard.exportDashboardPDF()">
                        <i class="fas fa-file-pdf"></i>
                        Export PDF
                    </button>
                    <button class="btn-primary" onclick="adminDashboard.showQuickActions()">
                        <i class="fas fa-plus"></i>
                        Quick Actions
                    </button>
                </div>
            </div>

            <!-- Stats Overview -->
            <div class="stats-overview">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="totalUsersCount">0</div>
                    <div class="stat-label">Total Users</div>
                    <div class="stat-trend positive">
                        <i class="fas fa-arrow-up"></i>
                        <span id="userGrowthTrend">Loading...</span>
                    </div>
                </div>

                <div class="stat-card warning">
                    <div class="stat-header">
                        <div class="stat-icon warning">
                            <i class="fas fa-user-clock"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="pendingVerificationsCount">0</div>
                    <div class="stat-label">Pending Verifications</div>
                    <div class="stat-trend neutral">
                        <i class="fas fa-clock"></i>
                        <span>Requires attention</span>
                    </div>
                </div>

                <div class="stat-card success">
                    <div class="stat-header">
                        <div class="stat-icon success">
                            <i class="fas fa-calendar"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="activeEventsCount">0</div>
                    <div class="stat-label">Active Events</div>
                    <div class="stat-trend positive">
                        <i class="fas fa-arrow-up"></i>
                        <span id="eventGrowthTrend">Loading...</span>
                    </div>
                </div>

                <div class="stat-card info">
                    <div class="stat-header">
                        <div class="stat-icon info">
                            <i class="fas fa-chart-line"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="platformActivity">0%</div>
                    <div class="stat-label">Platform Activity</div>
                    <div class="stat-trend positive">
                        <i class="fas fa-arrow-up"></i>
                        <span>High engagement</span>
                    </div>
                </div>
            </div>

            <!-- Dashboard Charts -->
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 30px;">
                <div class="chart-container">
                    <div class="section-header" style="margin-bottom: 20px;">
                        <h3 class="section-title">User Growth Trend</h3>
                    </div>
                    <canvas id="userGrowthChart" class="chart-canvas"></canvas>
                </div>

                <div class="chart-container">
                    <div class="section-header" style="margin-bottom: 20px;">
                        <h3 class="section-title">User Distribution</h3>
                    </div>
                    <canvas id="userDistributionChart" class="chart-canvas"></canvas>
                </div>
            </div>

            <!-- Recent Activities -->
            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Recent Activities</h2>
                    <div class="section-actions">
                        <button class="btn-secondary btn-sm" onclick="adminDashboard.viewAllActivities()">View
                            All</button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Activity</th>
                                <th>User</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="recentActivities">
                            <tr>
                                <td colspan="5" style="text-align: center; padding: 20px; color: var(--gray-500);">
                                    Loading activities...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- System Health -->
            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">System Health</h2>
                    <div class="section-actions">
                        <button class="btn-secondary btn-sm" onclick="adminDashboard.refreshSystemHealth()">
                            <i class="fas fa-sync-alt"></i>
                            Refresh
                        </button>
                    </div>
                </div>
                <div class="stats-overview">
                    <div class="stat-card success" style="margin: 0;">
                        <div class="stat-value" style="font-size: 1.5rem;" id="systemUptime">99.9%</div>
                        <div class="stat-label">Uptime</div>
                    </div>
                    <div class="stat-card" style="margin: 0;">
                        <div class="stat-value" style="font-size: 1.5rem;" id="avgResponse">Loading...</div>
                        <div class="stat-label">Avg Response</div>
                    </div>
                    <div class="stat-card info" style="margin: 0;">
                        <div class="stat-value" style="font-size: 1.5rem;" id="storageUsed">Loading...</div>
                        <div class="stat-label">Storage Used</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics View -->
        <div class="view-content" id="analyticsView">
            <div class="page-header">
                <h1 class="page-title">Analytics Dashboard</h1>
                <div class="page-actions">
                    <select class="form-select" style="width: auto;" id="analyticsTimeframe">
                        <option value="7d">Last 7 days</option>
                        <option value="30d" selected>Last 30 days</option>
                        <option value="90d">Last 3 months</option>
                        <option value="1y">Last year</option>
                    </select>
                    <button class="btn-primary" onclick="adminDashboard.exportAnalyticsPDF()">
                        <i class="fas fa-file-pdf"></i>
                        Export PDF
                    </button>
                </div>
            </div>

            <!-- Analytics Stats -->
            <div class="stats-overview">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-eye"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="totalPageViews">0</div>
                    <div class="stat-label">Page Views</div>
                    <div class="stat-trend positive">
                        <i class="fas fa-arrow-up"></i>
                        <span id="pageViewsTrend">Loading...</span>
                    </div>
                </div>

                <div class="stat-card info">
                    <div class="stat-header">
                        <div class="stat-icon info">
                            <i class="fas fa-users"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="uniqueVisitors">0</div>
                    <div class="stat-label">Unique Visitors</div>
                    <div class="stat-trend positive">
                        <i class="fas fa-arrow-up"></i>
                        <span id="visitorsTrend">Loading...</span>
                    </div>
                </div>

                <div class="stat-card success">
                    <div class="stat-header">
                        <div class="stat-icon success">
                            <i class="fas fa-user-plus"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="newRegistrations">0</div>
                    <div class="stat-label">New Registrations</div>
                    <div class="stat-trend positive">
                        <i class="fas fa-arrow-up"></i>
                        <span id="registrationsTrend">Loading...</span>
                    </div>
                </div>

                <div class="stat-card warning">
                    <div class="stat-header">
                        <div class="stat-icon warning">
                            <i class="fas fa-clock"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="avgSessionTime">0m 0s</div>
                    <div class="stat-label">Avg Session Time</div>
                    <div class="stat-trend negative">
                        <i class="fas fa-arrow-down"></i>
                        <span id="sessionTrend">Loading...</span>
                    </div>
                </div>
            </div>

            <!-- Analytics Charts -->
            <div class="chart-container">
                <div class="section-header" style="margin-bottom: 20px;">
                    <h3 class="section-title">Traffic Analytics</h3>
                </div>
                <canvas id="trafficChart" class="chart-canvas"></canvas>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="chart-container" style="height: 300px;">
                    <div class="section-header" style="margin-bottom: 15px;">
                        <h3 class="section-title">Content Engagement</h3>
                    </div>
                    <canvas id="engagementChart" class="chart-canvas"></canvas>
                </div>

                <div class="chart-container" style="height: 300px;">
                    <div class="section-header" style="margin-bottom: 15px;">
                        <h3 class="section-title">Popular Features</h3>
                    </div>
                    <canvas id="featuresChart" class="chart-canvas"></canvas>
                </div>
            </div>

            <!-- Top Content -->
            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Top Performing Content</h2>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Content</th>
                                <th>Type</th>
                                <th>Views</th>
                                <th>Engagement</th>
                                <th>Performance</th>
                            </tr>
                        </thead>
                        <tbody id="topContentTable">
                            <tr>
                                <td colspan="5" style="text-align: center; padding: 20px; color: var(--gray-500);">
                                    Loading content data...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Reports View -->
        <div class="view-content" id="reportsView">
            <div class="page-header">
                <h1 class="page-title">Reports & Analytics</h1>
                <div class="page-actions">
                    <button class="btn-secondary" onclick="adminDashboard.scheduleReport()">
                        <i class="fas fa-clock"></i>
                        Schedule Report
                    </button>
                    <button class="btn-primary" onclick="adminDashboard.generateCustomReport()">
                        <i class="fas fa-plus"></i>
                        Custom Report
                    </button>
                </div>
            </div>

            <!-- Report Categories -->
            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div class="report-card" onclick="adminDashboard.generateReportPDF('user')">
                    <div class="report-icon"
                        style="background: linear-gradient(135deg, var(--accent-blue), var(--bright-blue));">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3>User Reports</h3>
                    <p style="color: var(--gray-600); font-size: 0.9rem;">Registration trends, user activity,
                        demographics</p>
                    <div style="margin-top: 15px;">
                        <span class="status-badge active">Generate PDF</span>
                    </div>
                </div>

                <div class="report-card" onclick="adminDashboard.generateReportPDF('engagement')">
                    <div class="report-icon" style="background: linear-gradient(135deg, var(--success), #059669);">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3>Engagement Reports</h3>
                    <p style="color: var(--gray-600); font-size: 0.9rem;">Events participation, article views, Q&A
                        activity</p>
                    <div style="margin-top: 15px;">
                        <span class="status-badge active">Generate PDF</span>
                    </div>
                </div>

                <div class="report-card" onclick="adminDashboard.generateReportPDF('verification')">
                    <div class="report-icon" style="background: linear-gradient(135deg, var(--warning), #d97706);">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <h3>Verification Reports</h3>
                    <p style="color: var(--gray-600); font-size: 0.9rem;">Approval rates, pending requests, rejection
                        reasons</p>
                    <div style="margin-top: 15px;">
                        <span class="status-badge active">Generate PDF</span>
                    </div>
                </div>

                <div class="report-card" onclick="adminDashboard.generateReportPDF('content')">
                    <div class="report-icon" style="background: linear-gradient(135deg, var(--info), #2563eb);">
                        <i class="fas fa-newspaper"></i>
                    </div>
                    <h3>Content Reports</h3>
                    <p style="color: var(--gray-600); font-size: 0.9rem;">Article performance, event success, popular
                        topics</p>
                    <div style="margin-top: 15px;">
                        <span class="status-badge active">Generate PDF</span>
                    </div>
                </div>

                <div class="report-card" onclick="adminDashboard.generateReportPDF('system')">
                    <div class="report-icon" style="background: linear-gradient(135deg, var(--error), #dc2626);">
                        <i class="fas fa-server"></i>
                    </div>
                    <h3>System Reports</h3>
                    <p style="color: var(--gray-600); font-size: 0.9rem;">Performance metrics, error logs, uptime
                        statistics</p>
                    <div style="margin-top: 15px;">
                        <span class="status-badge active">Generate PDF</span>
                    </div>
                </div>

                <div class="report-card" onclick="adminDashboard.generateReportPDF('financial')">
                    <div class="report-icon"
                        style="background: linear-gradient(135deg, var(--primary-blue), var(--accent-blue));">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <h3>Financial Reports</h3>
                    <p style="color: var(--gray-600); font-size: 0.9rem;">Revenue tracking, cost analysis, budget
                        reports</p>
                    <div style="margin-top: 15px;">
                        <span class="status-badge active">Generate PDF</span>
                    </div>
                </div>
            </div>

            <!-- Recent Reports -->
            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Recent Reports</h2>
                    <button class="btn-secondary btn-sm" onclick="adminDashboard.viewAllReports()">View All</button>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Report Name</th>
                                <th>Type</th>
                                <th>Generated</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="recentReportsTable">
                            <tr>
                                <td colspan="5" style="text-align: center; padding: 20px; color: var(--gray-500);">
                                    Loading reports...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Settings View -->
        <div class="view-content" id="settingsView">
            <div class="page-header">
                <h1 class="page-title">System Settings</h1>
                <div class="page-actions">
                    <button class="btn-secondary" onclick="adminDashboard.backupSettings()">
                        <i class="fas fa-save"></i>
                        Backup Settings
                    </button>
                    <button class="btn-primary" onclick="adminDashboard.saveAllSettings()">
                        <i class="fas fa-check"></i>
                        Save Changes
                    </button>
                </div>
            </div>

            <!-- General Settings -->
            <div class="settings-card">
                <h3 style="margin-bottom: 20px; color: var(--gray-900);">
                    <i class="fas fa-cog" style="margin-right: 8px;"></i>
                    General Settings
                </h3>

                <div class="settings-item">
                    <div>
                        <strong>Platform Name</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">The name displayed across the platform</p>
                    </div>
                    <input type="text" class="form-input" value="Realm" style="width: 200px;" id="platformName">
                </div>

                <div class="settings-item">
                    <div>
                        <strong>Maintenance Mode</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Enable to temporarily disable user access
                        </p>
                    </div>
                    <div class="toggle-switch" id="maintenanceToggle"
                        onclick="adminDashboard.toggleSetting(this, 'maintenanceMode')"></div>
                </div>

                <div class="settings-item">
                    <div>
                        <strong>User Registration</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Allow new users to register</p>
                    </div>
                    <div class="toggle-switch active" id="registrationToggle"
                        onclick="adminDashboard.toggleSetting(this, 'userRegistration')"></div>
                </div>

                <div class="settings-item">
                    <div>
                        <strong>Email Notifications</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Send system notifications via email</p>
                    </div>
                    <div class="toggle-switch active" id="emailToggle"
                        onclick="adminDashboard.toggleSetting(this, 'emailNotifications')"></div>
                </div>
            </div>

            <!-- Security Settings -->
            <div class="settings-card">
                <h3 style="margin-bottom: 20px; color: var(--gray-900);">
                    <i class="fas fa-shield-alt" style="margin-right: 8px;"></i>
                    Security Settings
                </h3>

                <div class="settings-item">
                    <div>
                        <strong>Two-Factor Authentication</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Require 2FA for admin accounts</p>
                    </div>
                    <div class="toggle-switch" id="twoFactorToggle"
                        onclick="adminDashboard.toggleSetting(this, 'twoFactorAuth')"></div>
                </div>

                <div class="settings-item">
                    <div>
                        <strong>Session Timeout</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Automatic logout time (minutes)</p>
                    </div>
                    <input type="number" class="form-input" value="60" style="width: 100px;" id="sessionTimeout" min="5"
                        max="480">
                </div>

                <div class="settings-item">
                    <div>
                        <strong>Login Attempt Limit</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Max failed login attempts before lockout
                        </p>
                    </div>
                    <input type="number" class="form-input" value="5" style="width: 100px;" id="loginAttemptLimit"
                        min="3" max="10">
                </div>

                <div class="settings-item">
                    <div>
                        <strong>IP Whitelist</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Restrict admin access to specific IPs</p>
                    </div>
                    <div class="toggle-switch" id="ipWhitelistToggle"
                        onclick="adminDashboard.toggleSetting(this, 'ipWhitelist')"></div>
                </div>
            </div>

            <!-- Content Settings -->
            <div class="settings-card">
                <h3 style="margin-bottom: 20px; color: var(--gray-900);">
                    <i class="fas fa-newspaper" style="margin-right: 8px;"></i>
                    Content Settings
                </h3>

                <div class="settings-item">
                    <div>
                        <strong>Auto-approve Articles</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Automatically publish articles from
                            verified users</p>
                    </div>
                    <div class="toggle-switch" id="autoApproveToggle"
                        onclick="adminDashboard.toggleSetting(this, 'autoApproveArticles')"></div>
                </div>

                <div class="settings-item">
                    <div>
                        <strong>Comment Moderation</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Require approval for comments</p>
                    </div>
                    <div class="toggle-switch active" id="moderationToggle"
                        onclick="adminDashboard.toggleSetting(this, 'commentModeration')"></div>
                </div>

                <div class="settings-item">
                    <div>
                        <strong>File Upload Limit</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Maximum file size (MB)</p>
                    </div>
                    <input type="number" class="form-input" value="10" style="width: 100px;" id="fileUploadLimit"
                        min="1" max="100">
                </div>
            </div>

            <!-- Notification Settings -->
            <div class="settings-card">
                <h3 style="margin-bottom: 20px; color: var(--gray-900);">
                    <i class="fas fa-bell" style="margin-right: 8px;"></i>
                    Notification Settings
                </h3>

                <div class="settings-item">
                    <div>
                        <strong>New User Notifications</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Notify admins of new registrations</p>
                    </div>
                    <div class="toggle-switch active" id="newUserToggle"
                        onclick="adminDashboard.toggleSetting(this, 'newUserNotifications')"></div>
                </div>

                <div class="settings-item">
                    <div>
                        <strong>System Alert Notifications</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Alert for system issues</p>
                    </div>
                    <div class="toggle-switch active" id="systemAlertsToggle"
                        onclick="adminDashboard.toggleSetting(this, 'systemAlerts')"></div>
                </div>

                <div class="settings-item">
                    <div>
                        <strong>Weekly Reports</strong>
                        <p style="color: var(--gray-600); font-size: 0.9rem;">Send weekly activity reports</p>
                    </div>
                    <div class="toggle-switch active" id="weeklyReportsToggle"
                        onclick="adminDashboard.toggleSetting(this, 'weeklyReports')"></div>
                </div>
            </div>
        </div>

        <!-- Students View -->
        <div class="view-content" id="studentsView">
            <div class="page-header">
                <h1 class="page-title">Student Management</h1>
                <div class="page-actions">
                    <button class="btn-secondary" onclick="adminDashboard.toggleFilter('students')">
                        <i class="fas fa-filter"></i>
                        Filter
                    </button>
                    <button class="btn-primary" onclick="openUserModal('student')">
                        <i class="fas fa-plus"></i>
                        Add Student
                    </button>
                </div>
            </div>

            <!-- Filter Panel -->
            <div class="filter-panel" id="studentsFilter">
                <div class="filter-row">
                    <div class="form-group">
                        <label class="form-label">Course</label>
                        <select class="form-select" id="courseFilter">
                            <option value="">All Courses</option>
                            <option value="btech">B.Tech</option>
                            <option value="mtech">M.Tech</option>
                            <option value="mba">MBA</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-select" id="statusFilter">
                            <option value="">All Status</option>
                            <option value="verified">Verified</option>
                            <option value="pending">Pending</option>
                            <option value="rejected">Rejected</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Year</label>
                        <select class="form-select" id="yearFilter">
                            <option value="">All Years</option>
                            <option value="1">1st Year</option>
                            <option value="2">2nd Year</option>
                            <option value="3">3rd Year</option>
                            <option value="4">4th Year</option>
                        </select>
                    </div>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn-primary" onclick="adminDashboard.applyFilters('students')">Apply Filters</button>
                    <button class="btn-secondary" onclick="adminDashboard.clearFilters('students')">Clear</button>
                </div>
            </div>

            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">All Students (<span id="studentsTotal">0</span>)</h2>
                    <div class="section-actions">
                        <button class="btn-secondary btn-sm" onclick="adminDashboard.exportStudentsPDF()">
                            <i class="fas fa-file-pdf"></i>
                            Export PDF
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Student</th>
                                <th>Course</th>
                                <th>Year</th>
                                <th>Status</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="studentsTableBody">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 20px; color: var(--gray-500);">
                                    Loading students...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Alumni View -->
        <div class="view-content" id="alumniView">
            <div class="page-header">
                <h1 class="page-title">Alumni Management</h1>
                <div class="page-actions">
                    <button class="btn-secondary" onclick="adminDashboard.toggleFilter('alumni')">
                        <i class="fas fa-filter"></i>
                        Filter
                    </button>
                    <button class="btn-primary" onclick="openUserModal('alumni')">
                        <i class="fas fa-plus"></i>
                        Add Alumni
                    </button>
                </div>
            </div>

            <!-- Filter Panel -->
            <div class="filter-panel" id="alumniFilter">
                <div class="filter-row">
                    <div class="form-group">
                        <label class="form-label">Course</label>
                        <select class="form-select" id="alumniCourseFilter">
                            <option value="">All Courses</option>
                            <option value="btech">B.Tech</option>
                            <option value="mtech">M.Tech</option>
                            <option value="mba">MBA</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Passing Year</label>
                        <select class="form-select" id="passingYearFilter">
                            <option value="">All Years</option>
                            <option value="2024">2024</option>
                            <option value="2023">2023</option>
                            <option value="2022">2022</option>
                            <option value="2021">2021</option>
                            <option value="2020">2020</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-select" id="alumniStatusFilter">
                            <option value="">All Status</option>
                            <option value="verified">Verified</option>
                            <option value="pending">Pending</option>
                        </select>
                    </div>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn-primary" onclick="adminDashboard.applyFilters('alumni')">Apply Filters</button>
                    <button class="btn-secondary" onclick="adminDashboard.clearFilters('alumni')">Clear</button>
                </div>
            </div>

            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">All Alumni (<span id="alumniTotal">0</span>)</h2>
                    <div class="section-actions">
                        <button class="btn-secondary btn-sm" onclick="adminDashboard.exportAlumniPDF()">
                            <i class="fas fa-file-pdf"></i>
                            Export PDF
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Alumni</th>
                                <th>Course</th>
                                <th>Passing Year</th>
                                <th>Current Role</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="alumniTableBody">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 20px; color: var(--gray-500);">
                                    Loading alumni...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Verifications View -->
        <div class="view-content" id="verificationsView">
            <div class="page-header">
                <h1 class="page-title">Student Verification Requests</h1>
                <div class="page-actions">
                    <button class="btn-primary" onclick="adminDashboard.refreshVerifications()">
                        <i class="fas fa-sync-alt"></i>
                        Refresh
                    </button>
                </div>
            </div>
            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Pending Verifications (<span id="pendingCount">0</span>)</h2>
                </div>
                <div id="verificationContainer">
                    <p style="text-align: center; color: var(--gray-500); padding: 40px;">
                        Loading verification requests...
                    </p>
                </div>
            </div>
        </div>

        <!-- Events View -->
        <div class="view-content" id="eventsView">
            <div class="page-header">
                <h1 class="page-title">Event Management</h1>
                <div class="page-actions">
                    <button class="btn-secondary">
                        <i class="fas fa-calendar"></i>
                        Calendar View
                    </button>
                    <button class="btn-primary" onclick="openEventModal()">
                        <i class="fas fa-plus"></i>
                        Create Event
                    </button>
                </div>
            </div>

            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">All Events (<span id="eventsTotal">0</span>)</h2>
                    <div class="section-actions">
                        <button class="btn-secondary btn-sm" onclick="adminDashboard.exportEventsPDF()">
                            <i class="fas fa-file-pdf"></i>
                            Export PDF
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Host</th>
                                <th>Date</th>
                                <th>Attendees</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="eventsTableBody">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 20px; color: var(--gray-500);">
                                    Loading events...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Articles View -->
        <div class="view-content" id="articlesView">
            <div class="page-header">
                <h1 class="page-title">Article Management</h1>
                <div class="page-actions">
                    <button class="btn-secondary" onclick="adminDashboard.toggleFilter('articles')">
                        <i class="fas fa-filter"></i>
                        Filter
                    </button>
                    <button class="btn-primary" onclick="adminDashboard.createArticle()">
                        <i class="fas fa-plus"></i>
                        Create Article
                    </button>
                </div>
            </div>

            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">All Articles (<span id="articlesTotal">0</span>)</h2>
                    <div class="section-actions">
                        <button class="btn-secondary btn-sm" onclick="adminDashboard.exportArticlesPDF()">
                            <i class="fas fa-file-pdf"></i>
                            Export PDF
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Article</th>
                                <th>Author</th>
                                <th>Category</th>
                                <th>Status</th>
                                <th>Published</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="articlesTableBody">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 20px; color: var(--gray-500);">
                                    Loading articles...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Questions View -->
        <div class="view-content" id="questionsView">
            <div class="page-header">
                <h1 class="page-title">Q&A Board Management</h1>
                <div class="page-actions">
                    <button class="btn-secondary" onclick="adminDashboard.moderateQuestions()">
                        <i class="fas fa-shield-alt"></i>
                        Moderate
                    </button>
                    <button class="btn-primary" onclick="adminDashboard.exportQuestionsPDF()">
                        <i class="fas fa-file-pdf"></i>
                        Export PDF
                    </button>
                </div>
            </div>

            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">All Questions (<span id="questionsTotal">0</span>)</h2>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Question</th>
                                <th>Asked By</th>
                                <th>Answers</th>
                                <th>Category</th>
                                <th>Posted</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="questionsTableBody">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 20px; color: var(--gray-500);">
                                    Loading questions...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- User Management Modal -->
    <div class="modal-overlay hidden" id="userModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="userModalTitle">Add User</h2>
                <button class="modal-close" onclick="closeModal('userModal')">&times;</button>
            </div>
            <form id="userForm">
                <div class="form-group">
                    <label class="form-label">Full Name *</label>
                    <input type="text" class="form-input" name="fullName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email *</label>
                    <input type="email" class="form-input" name="email" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Role *</label>
                    <select class="form-select" id="userRole" name="role" required>
                        <option value="student">Student</option>
                        <option value="alumni">Alumni</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Course</label>
                    <input type="text" class="form-input" name="course">
                </div>
                <div class="form-group" id="yearGroup">
                    <label class="form-label" id="yearLabel">Current Year</label>
                    <input type="number" class="form-input" name="year" min="1" max="5">
                </div>
                <div class="form-group">
                    <label class="form-label">Phone</label>
                    <input type="tel" class="form-input" name="phone">
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="button" class="btn-secondary" onclick="closeModal('userModal')">Cancel</button>
                    <button type="submit" class="btn-primary">
                        <span class="btn-text">Save User</span>
                        <div class="spinner" style="display: none;"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Event Modal -->
    <div class="modal-overlay hidden" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create Event</h2>
                <button class="modal-close" onclick="closeModal('eventModal')">&times;</button>
            </div>
            <form id="eventForm">
                <div class="form-group">
                    <label class="form-label">Event Title *</label>
                    <input type="text" class="form-input" name="title" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Description *</label>
                    <textarea class="form-textarea" name="description" required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Date & Time *</label>
                    <input type="datetime-local" class="form-input" name="datetime" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Max Attendees *</label>
                    <input type="number" class="form-input" name="maxAttendees" min="1" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Host</label>
                    <input type="text" class="form-input" name="host">
                </div>
                <div class="form-group">
                    <label class="form-label">Location/Link</label>
                    <input type="text" class="form-input" name="location" placeholder="Venue or meeting link">
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="button" class="btn-secondary" onclick="closeModal('eventModal')">Cancel</button>
                    <button type="submit" class="btn-primary">
                        <span class="btn-text">Create Event</span>
                        <div class="spinner" style="display: none;"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Verification Details Modal -->
    <div class="modal-overlay hidden" id="verificationModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="modal-title">Student Verification Details</h2>
                <button class="modal-close" onclick="adminDashboard.closeModal('verificationModal')">&times;</button>
            </div>
            <div id="verificationDetails"></div>
            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn-success" id="approveBtn" onclick="adminDashboard.approveVerification()">
                    <i class="fas fa-check"></i>
                    <span class="btn-text">Approve</span>
                    <div class="spinner" style="display: none;"></div>
                </button>
                <button class="btn-danger" id="rejectBtn" onclick="adminDashboard.showRejectModal()">
                    <i class="fas fa-times"></i>
                    Reject
                </button>
            </div>
        </div>
    </div>

    <!-- Rejection Modal -->
    <div class="modal-overlay hidden" id="rejectionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Reject Verification</h2>
                <button class="modal-close" onclick="adminDashboard.closeModal('rejectionModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Reason for Rejection *</label>
                <textarea id="rejectionReason" class="form-textarea"
                    placeholder="Please provide a clear reason for rejection..." required></textarea>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn-secondary" onclick="adminDashboard.closeModal('rejectionModal')">Cancel</button>
                <button class="btn-danger" onclick="adminDashboard.rejectVerification()">
                    <i class="fas fa-times"></i>
                    <span class="btn-text">Reject</span>
                    <div class="spinner" style="display: none;"></div>
                </button>
            </div>
        </div>
    </div>

    <!-- Profile Settings Modal -->
    <div class="modal-overlay hidden" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Admin Profile Settings</h2>
                <button class="modal-close" onclick="adminDashboard.closeModal('profileModal')">&times;</button>
            </div>
            <form id="profileForm">
                <div class="form-group">
                    <label class="form-label">Full Name *</label>
                    <input type="text" class="form-input" name="fullName" value="Admin User" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email *</label>
                    <input type="email" class="form-input" name="email" value="admin@realm.com" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Phone</label>
                    <input type="tel" class="form-input" name="phone">
                </div>
                <div class="form-group">
                    <label class="form-label">New Password</label>
                    <input type="password" class="form-input" name="newPassword"
                        placeholder="Leave blank to keep current">
                </div>
                <div class="form-group">
                    <label class="form-label">Confirm Password</label>
                    <input type="password" class="form-input" name="confirmPassword" placeholder="Confirm new password">
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="button" class="btn-secondary"
                        onclick="adminDashboard.closeModal('profileModal')">Cancel</button>
                    <button type="submit" class="btn-primary">
                        <span class="btn-text">Update Profile</span>
                        <div class="spinner" style="display: none;"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global configuration
        const CONFIG = {
            API_BASE_URL: 'http://localhost:3000/api', // Change to your backend URL
            SOCKET_URL: 'http://localhost:3000', // Change to your socket server URL
            ITEMS_PER_PAGE: 10,
            SEARCH_DEBOUNCE: 300,
            AUTO_REFRESH_INTERVAL: 30000 // 30 seconds
        };

        class AdminDashboard {
            constructor() {
                this.currentView = 'dashboard';
                this.apiBaseUrl = CONFIG.API_BASE_URL;
                this.currentVerification = null;
                this.authHeaders = {};
                this.searchTimeout = null;
                this.socket = null;
                this.charts = {};
                this.currentPage = 1;
                this.filters = {};
                this.notifications = [];
                this.settings = {
                    maintenanceMode: false,
                    userRegistration: true,
                    emailNotifications: true,
                    twoFactorAuth: false,
                    sessionTimeout: 60,
                    loginAttemptLimit: 5,
                    ipWhitelist: false,
                    autoApproveArticles: false,
                    commentModeration: true,
                    fileUploadLimit: 10,
                    newUserNotifications: true,
                    systemAlerts: true,
                    weeklyReports: true
                };
                this.init();
            }

            async init() {
                this.log('Admin Dashboard initializing...');
                this.checkAuthentication();
                this.bindEvents();
                this.initializeSocket();
                await this.loadInitialData();
                this.startAutoRefresh();
                this.showConnectionStatus();
            }

            log(message) {
                console.log(`[AdminDashboard] ${new Date().toLocaleTimeString()} - ${message}`);
            }

            checkAuthentication() {
                const token = localStorage.getItem('authToken');
                const role = localStorage.getItem('userRole');
                const testMode = false; // Set to true for testing without backend

                this.log(`Token: ${token ? 'Present' : 'Missing'}, Role: ${role}`);

                if (testMode) {
                    this.log('Running in test mode - using sample data');
                    this.authHeaders = { 'Content-Type': 'application/json' };
                    return;
                }

                if (!token) {
                    this.log('No token found - redirecting to login');
                    window.location.href = './login.html';
                    return;
                }

                if (role !== 'admin') {
                    this.log(`Invalid role: ${role}, redirecting to login`);
                    window.location.href = './login.html';
                    return;
                }

                this.authHeaders = {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                };
            }

            initializeSocket() {
                try {
                    this.socket = io(CONFIG.SOCKET_URL);

                    this.socket.on('connect', () => {
                        this.log('Socket connected successfully');
                        this.updateConnectionStatus(true);
                        this.socket.emit('join-admin-room');
                    });

                    this.socket.on('disconnect', () => {
                        this.log('Socket disconnected');
                        this.updateConnectionStatus(false);
                    });

                    // Real-time notifications
                    this.socket.on('new-notification', (notification) => {
                        this.handleNewNotification(notification);
                    });

                    // Real-time data updates
                    this.socket.on('data-update', (data) => {
                        this.handleDataUpdate(data);
                    });

                    // Real-time user activity
                    this.socket.on('user-activity', (activity) => {
                        this.handleUserActivity(activity);
                    });

                } catch (error) {
                    this.log('Socket connection failed: ' + error.message);
                    this.updateConnectionStatus(false);
                }
            }

            updateConnectionStatus(isOnline) {
                const status = document.getElementById('connectionStatus');
                if (isOnline) {
                    status.className = 'connection-status online';
                    status.innerHTML = '<i class="fas fa-wifi"></i> <span>Connected</span>';
                } else {
                    status.className = 'connection-status offline';
                    status.innerHTML = '<i class="fas fa-wifi"></i> <span>Disconnected</span>';
                }
                status.style.display = 'block';

                // Hide after 3 seconds if online
                if (isOnline) {
                    setTimeout(() => {
                        status.style.display = 'none';
                    }, 3000);
                }
            }

            showConnectionStatus() {
                this.updateConnectionStatus(navigator.onLine);

                window.addEventListener('online', () => {
                    this.updateConnectionStatus(true);
                    this.refreshCurrentView();
                });

                window.addEventListener('offline', () => {
                    this.updateConnectionStatus(false);
                });
            }

            handleNewNotification(notification) {
                this.notifications.unshift(notification);
                this.updateNotificationBadge();
                this.renderNotifications();

                // Show toast notification
                this.showNotificationToast(notification);
            }

            handleDataUpdate(data) {
                this.log(`Received data update: ${data.type}`);

                switch (data.type) {
                    case 'user_created':
                    case 'user_updated':
                    case 'user_deleted':
                        if (this.currentView === 'students' || this.currentView === 'alumni') {
                            this.loadViewData(this.currentView);
                        }
                        break;
                    case 'verification_submitted':
                        if (this.currentView === 'verifications') {
                            this.loadVerificationRequests();
                        }
                        this.updateDashboardStats();
                        break;
                    case 'event_created':
                    case 'event_updated':
                        if (this.currentView === 'events') {
                            this.loadEventsData();
                        }
                        break;
                }
            }

            handleUserActivity(activity) {
                // Update recent activities in real-time
                if (this.currentView === 'dashboard') {
                    this.loadRecentActivities();
                }
            }

            showNotificationToast(notification) {
                const toast = document.createElement('div');
                toast.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--info);
                    color: white;
                    padding: 15px 20px;
                    border-radius: var(--radius-lg);
                    z-index: 2500;
                    box-shadow: var(--shadow-xl);
                    font-weight: 500;
                    max-width: 300px;
                    cursor: pointer;
                `;
                toast.innerHTML = `
                    <div style="font-weight: 600; margin-bottom: 5px;">${notification.title}</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">${notification.message}</div>
                `;

                toast.onclick = () => {
                    toast.remove();
                    this.handleNotificationClick(notification);
                };

                document.body.appendChild(toast);

                setTimeout(() => {
                    toast.remove();
                }, 5000);
            }

            bindEvents() {
                this.log('Binding events...');

                // Profile dropdown
                const profileAvatar = document.getElementById('profileAvatar');
                if (profileAvatar) {
                    profileAvatar.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.toggleProfileDropdown();
                    });
                }

                // Notification panel
                const notificationBtn = document.getElementById('notificationBtn');
                if (notificationBtn) {
                    notificationBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.toggleNotificationPanel();
                    });
                }

                // Close dropdowns when clicking outside
                document.addEventListener('click', () => {
                    this.closeProfileDropdown();
                    this.hideSearchResults();
                    this.hideNotificationPanel();
                });

                // Search functionality
                const searchInput = document.getElementById('globalSearch');
                searchInput.addEventListener('input', (e) => {
                    clearTimeout(this.searchTimeout);
                    this.searchTimeout = setTimeout(() => {
                        this.performSearch(e.target.value);
                    }, CONFIG.SEARCH_DEBOUNCE);
                });

                searchInput.addEventListener('focus', () => {
                    if (searchInput.value.trim()) {
                        this.performSearch(searchInput.value);
                    }
                });

                document.getElementById('searchBtn').addEventListener('click', () => {
                    this.performSearch(searchInput.value);
                });

                // Sidebar navigation
                document.querySelectorAll('.sidebar-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        const view = item.getAttribute('data-view');
                        if (view) {
                            this.switchView(view);
                        }
                    });
                });

                // Logout
                const logoutBtn = document.getElementById('logoutBtn');
                if (logoutBtn) {
                    logoutBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.logout();
                    });
                }

                // Form submissions
                document.getElementById('userForm').addEventListener('submit', (e) => {
                    this.handleUserSubmission(e);
                });

                document.getElementById('eventForm').addEventListener('submit', (e) => {
                    this.handleEventSubmission(e);
                });

                document.getElementById('profileForm').addEventListener('submit', (e) => {
                    this.handleProfileSubmission(e);
                });

                // User role change handler
                document.getElementById('userRole').addEventListener('change', (e) => {
                    this.updateUserForm(e.target.value);
                });

                // Analytics timeframe change
                const analyticsTimeframe = document.getElementById('analyticsTimeframe');
                if (analyticsTimeframe) {
                    analyticsTimeframe.addEventListener('change', (e) => {
                        this.updateAnalytics(e.target.value);
                    });
                }

                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    this.handleKeyboardShortcuts(e);
                });

                this.log('Events bound successfully');
            }

            handleKeyboardShortcuts(e) {
                // Ctrl/Cmd + K for search
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    document.getElementById('globalSearch').focus();
                }

                // Escape to close modals/dropdowns
                if (e.key === 'Escape') {
                    this.closeAllModals();
                    this.closeProfileDropdown();
                    this.hideSearchResults();
                    this.hideNotificationPanel();
                }
            }

            async loadInitialData() {
                this.log('Loading initial data...');

                try {
                    // Load settings
                    await this.loadSettings();

                    // Load dashboard data
                    await this.loadDashboardData();

                    // Load notifications
                    await this.loadNotifications();

                    this.log('Initial data loaded successfully');
                } catch (error) {
                    this.log('Error loading initial data: ' + error.message);
                    this.showError('Failed to load initial data. Please refresh the page.');
                }
            }

            startAutoRefresh() {
                setInterval(() => {
                    if (this.currentView === 'dashboard') {
                        this.updateDashboardStats();
                        this.refreshSystemHealth();
                    }
                }, CONFIG.AUTO_REFRESH_INTERVAL);
            }

            // API Methods
            async apiRequest(endpoint, options = {}) {
                const url = `${this.apiBaseUrl}${endpoint}`;
                const config = {
                    headers: this.authHeaders,
                    ...options
                };

                try {
                    const response = await fetch(url, config);

                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    return await response.json();
                } catch (error) {
                    this.log(`API request failed: ${error.message}`);
                    throw error;
                }
            }

            async loadSettings() {
                try {
                    const response = await this.apiRequest('/admin/settings');
                    this.settings = { ...this.settings, ...response.data };
                    this.applySettingsToUI();
                } catch (error) {
                    this.log('Failed to load settings, using defaults');
                }
            }

            applySettingsToUI() {
                // Apply toggle states
                document.getElementById('maintenanceToggle').classList.toggle('active', this.settings.maintenanceMode);
                document.getElementById('registrationToggle').classList.toggle('active', this.settings.userRegistration);
                document.getElementById('emailToggle').classList.toggle('active', this.settings.emailNotifications);
                document.getElementById('twoFactorToggle').classList.toggle('active', this.settings.twoFactorAuth);
                document.getElementById('ipWhitelistToggle').classList.toggle('active', this.settings.ipWhitelist);
                document.getElementById('autoApproveToggle').classList.toggle('active', this.settings.autoApproveArticles);
                document.getElementById('moderationToggle').classList.toggle('active', this.settings.commentModeration);
                document.getElementById('newUserToggle').classList.toggle('active', this.settings.newUserNotifications);
                document.getElementById('systemAlertsToggle').classList.toggle('active', this.settings.systemAlerts);
                document.getElementById('weeklyReportsToggle').classList.toggle('active', this.settings.weeklyReports);

                // Apply input values
                document.getElementById('platformName').value = this.settings.platformName || 'Realm';
                document.getElementById('sessionTimeout').value = this.settings.sessionTimeout || 60;
                document.getElementById('loginAttemptLimit').value = this.settings.loginAttemptLimit || 5;
                document.getElementById('fileUploadLimit').value = this.settings.fileUploadLimit || 10;
            }

            // Search Implementation with Backend
            async performSearch(query) {
                if (!query || query.trim().length < 2) {
                    this.hideSearchResults();
                    return;
                }

                try {
                    const response = await this.apiRequest(`/admin/search?q=${encodeURIComponent(query)}`);
                    this.displaySearchResults(response.data);
                } catch (error) {
                    // Fallback to local search
                    const results = this.localSearch(query);
                    this.displaySearchResults(results);
                }
            }

            localSearch(query) {
                const searchData = [
                    { type: 'user', title: 'John Doe', desc: 'B.Tech Computer Science - Student', id: 'user_1' },
                    { type: 'user', title: 'Alice Smith', desc: 'B.Tech IT - Student', id: 'user_2' },
                    { type: 'user', title: 'Mike Brown', desc: 'Senior Software Engineer - Alumni', id: 'user_3' },
                    { type: 'event', title: 'Tech Career AMA', desc: 'Q&A session about tech careers', id: 'event_1' },
                    { type: 'event', title: 'Resume Workshop', desc: 'How to build a winning resume', id: 'event_2' },
                    { type: 'article', title: 'Breaking into Tech', desc: 'Complete guide for tech careers', id: 'article_1' },
                    { type: 'article', title: 'Remote Work Best Practices', desc: 'Tips for remote productivity', id: 'article_2' },
                    { type: 'setting', title: 'User Management', desc: 'Manage students and alumni', id: 'students' },
                    { type: 'setting', title: 'Analytics Dashboard', desc: 'View platform analytics', id: 'analytics' },
                    { type: 'setting', title: 'System Settings', desc: 'Configure platform settings', id: 'settings' }
                ].sort((a, b) => a.title.toLowerCase().localeCompare(b.title.toLowerCase()));

                const results = [];
                const queryLower = query.toLowerCase();

                for (const item of searchData) {
                    if (item.title.toLowerCase().includes(queryLower) ||
                        item.desc.toLowerCase().includes(queryLower)) {
                        results.push(item);
                    }
                }

                return results.slice(0, 8);
            }

            displaySearchResults(results) {
                const searchResultsDiv = document.getElementById('searchResults');

                if (results.length === 0) {
                    searchResultsDiv.innerHTML = '<div class="search-result-item">No results found</div>';
                } else {
                    searchResultsDiv.innerHTML = results.map(result => `
                        <div class="search-result-item" onclick="adminDashboard.selectSearchResult('${result.type}', '${result.id}')">
                            <div class="search-result-type">${result.type}</div>
                            <div class="search-result-title">${result.title}</div>
                            <div class="search-result-desc">${result.desc}</div>
                        </div>
                    `).join('');
                }

                searchResultsDiv.style.display = 'block';
            }

            selectSearchResult(type, id) {
                this.hideSearchResults();

                switch (type) {
                    case 'user':
                        this.switchView('students');
                        this.highlightUser(id);
                        break;
                    case 'event':
                        this.switchView('events');
                        this.highlightEvent(id);
                        break;
                    case 'article':
                        this.switchView('articles');
                        this.highlightArticle(id);
                        break;
                    case 'setting':
                        this.switchView(id);
                        break;
                }

                document.getElementById('globalSearch').value = '';
            }

            hideSearchResults() {
                document.getElementById('searchResults').style.display = 'none';
            }

            highlightUser(userId) {
                setTimeout(() => {
                    const userRow = document.querySelector(`[data-user-id="${userId}"]`);
                    if (userRow) {
                        userRow.style.background = '#e6f3ff';
                        userRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        setTimeout(() => {
                            userRow.style.background = '';
                        }, 3000);
                    }
                }, 100);
            }

            highlightEvent(eventId) {
                setTimeout(() => {
                    const eventRow = document.querySelector(`[data-event-id="${eventId}"]`);
                    if (eventRow) {
                        eventRow.style.background = '#e6f3ff';
                        eventRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        setTimeout(() => {
                            eventRow.style.background = '';
                        }, 3000);
                    }
                }, 100);
            }

            highlightArticle(articleId) {
                setTimeout(() => {
                    const articleRow = document.querySelector(`[data-article-id="${articleId}"]`);
                    if (articleRow) {
                        articleRow.style.background = '#e6f3ff';
                        articleRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        setTimeout(() => {
                            articleRow.style.background = '';
                        }, 3000);
                    }
                }, 100);
            }

            // View Management
            switchView(view) {
                this.log(`Switching to view: ${view}`);

                document.querySelectorAll('.view-content').forEach(content => {
                    content.classList.remove('active');
                });

                const viewElement = document.getElementById(`${view}View`);
                if (viewElement) {
                    viewElement.classList.add('active');
                }

                document.querySelectorAll('.sidebar-item').forEach(item => {
                    item.classList.remove('active');
                });
                document.querySelectorAll('.sidebar-item').forEach(item => {
                    item.classList.remove('active');
                });

                const activeItem = document.querySelector(`[data-view="${view}"]`);
                if (activeItem) {
                    activeItem.classList.add('active');
                }

                this.currentView = view;
                this.loadViewData(view);
            }

            async loadViewData(view) {
                switch (view) {
                    case 'dashboard':
                        await this.loadDashboardData();
                        break;
                    case 'students':
                        await this.loadStudentsData();
                        break;
                    case 'alumni':
                        await this.loadAlumniData();
                        break;
                    case 'events':
                        await this.loadEventsData();
                        break;
                    case 'verifications':
                        await this.loadVerificationRequests();
                        break;
                    case 'analytics':
                        await this.loadAnalyticsData();
                        break;
                    case 'reports':
                        await this.loadReportsData();
                        break;
                    case 'settings':
                        await this.loadSettingsData();
                        break;
                    case 'articles':
                        await this.loadArticlesData();
                        break;
                    case 'questions':
                        await this.loadQuestionsData();
                        break;
                }
            }

            refreshCurrentView() {
                this.loadViewData(this.currentView);
            }

            async loadDashboardData() {
                this.log('Loading dashboard data...');

                try {
                    await Promise.all([
                        this.updateDashboardStats(),
                        this.loadRecentActivities(),
                        this.refreshSystemHealth(),
                        this.initializeDashboardCharts()
                    ]);
                } catch (error) {
                    this.log('Error loading dashboard data: ' + error.message);
                }
            }

            async updateDashboardStats() {
                try {
                    const response = await this.apiRequest('/admin/stats');
                    const stats = response.data;

                    document.getElementById('totalUsersCount').textContent = stats.totalUsers || 0;
                    document.getElementById('pendingVerificationsCount').textContent = stats.pendingVerifications || 0;
                    document.getElementById('activeEventsCount').textContent = stats.activeEvents || 0;
                    document.getElementById('platformActivity').textContent = (stats.platformActivity || 0) + '%';

                    // Update trends
                    document.getElementById('userGrowthTrend').textContent = stats.userGrowthTrend || '+0% this month';
                    document.getElementById('eventGrowthTrend').textContent = stats.eventGrowthTrend || '+0% this week';

                    // Update sidebar counts
                    this.updateSidebarCounts(stats);

                } catch (error) {
                    // Fallback to demo data
                    this.loadDemoStats();
                }
            }

            loadDemoStats() {
                const stats = {
                    totalUsers: 404,
                    pendingVerifications: 3,
                    activeEvents: 12,
                    platformActivity: 89,
                    students: 248,
                    alumni: 156,
                    events: 42,
                    articles: 78,
                    questions: 134
                };

                document.getElementById('totalUsersCount').textContent = stats.totalUsers;
                document.getElementById('pendingVerificationsCount').textContent = stats.pendingVerifications;
                document.getElementById('activeEventsCount').textContent = stats.activeEvents;
                document.getElementById('platformActivity').textContent = stats.platformActivity + '%';

                document.getElementById('userGrowthTrend').textContent = '+12% this month';
                document.getElementById('eventGrowthTrend').textContent = '+8 this week';

                this.updateSidebarCounts(stats);
            }

            updateSidebarCounts(stats) {
                const elements = {
                    'studentsCount': stats.students || 0,
                    'alumniCount': stats.alumni || 0,
                    'verificationCount': stats.pendingVerifications || 0,
                    'eventsCount': stats.events || 0,
                    'articlesCount': stats.articles || 0,
                    'questionsCount': stats.questions || 0
                };

                Object.entries(elements).forEach(([id, count]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = count;
                        element.style.display = count > 0 ? 'inline' : 'none';
                    }
                });
            }

            async loadRecentActivities() {
                try {
                    const response = await this.apiRequest('/admin/activities?limit=10');
                    this.renderRecentActivities(response.data);
                } catch (error) {
                    this.renderDemoActivities();
                }
            }

            renderRecentActivities(activities) {
                const tbody = document.getElementById('recentActivities');

                if (activities.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 20px; color: var(--gray-500);">No recent activities</td></tr>';
                    return;
                }

                tbody.innerHTML = activities.map(activity => `
                    <tr>
                        <td>${this.timeAgo(activity.timestamp)}</td>
                        <td>${activity.description}</td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div class="user-avatar">${activity.user.initials}</div>
                                ${activity.user.name}
                            </div>
                        </td>
                        <td><span class="status-badge ${activity.status}">${activity.status}</span></td>
                        <td>
                            ${activity.actions.map(action =>
                    `<button class="btn-${this.getActionButtonClass(action)} btn-sm" onclick="adminDashboard.handleActivity('${action}', '${activity.id}')">${action}</button>`
                ).join(' ')}
                        </td>
                    </tr>
                `).join('');
            }

            renderDemoActivities() {
                const activities = [
                    {
                        id: '1',
                        timestamp: new Date(Date.now() - 2 * 60 * 1000),
                        description: 'New student verification request',
                        user: { name: 'John Doe', initials: 'JD' },
                        status: 'pending',
                        actions: ['approve', 'reject']
                    },
                    {
                        id: '2',
                        timestamp: new Date(Date.now() - 5 * 60 * 1000),
                        description: 'Event created',
                        user: { name: 'Alice Smith', initials: 'AS' },
                        status: 'active',
                        actions: ['view']
                    },
                    {
                        id: '3',
                        timestamp: new Date(Date.now() - 12 * 60 * 1000),
                        description: 'Article published',
                        user: { name: 'Mike Brown', initials: 'MB' },
                        status: 'published',
                        actions: ['view']
                    }
                ];

                this.renderRecentActivities(activities);
            }

            getActionButtonClass(action) {
                const classes = {
                    approve: 'success',
                    reject: 'danger',
                    view: 'secondary',
                    edit: 'secondary',
                    delete: 'danger'
                };
                return classes[action] || 'secondary';
            }

            timeAgo(date) {
                const seconds = Math.floor((new Date() - new Date(date)) / 1000);

                let interval = seconds / 31536000;
                if (interval > 1) return Math.floor(interval) + " years ago";

                interval = seconds / 2592000;
                if (interval > 1) return Math.floor(interval) + " months ago";

                interval = seconds / 86400;
                if (interval > 1) return Math.floor(interval) + " days ago";

                interval = seconds / 3600;
                if (interval > 1) return Math.floor(interval) + " hours ago";

                interval = seconds / 60;
                if (interval > 1) return Math.floor(interval) + " minutes ago";

                return "just now";
            }

            async refreshSystemHealth() {
                try {
                    const response = await this.apiRequest('/admin/system-health');
                    const health = response.data;

                    document.getElementById('systemUptime').textContent = health.uptime || '99.9%';
                    document.getElementById('avgResponse').textContent = health.avgResponseTime || '1.2s';
                    document.getElementById('storageUsed').textContent = health.storageUsed || '45GB';

                } catch (error) {
                    // Demo data
                    document.getElementById('systemUptime').textContent = (99.9 + Math.random() * 0.1).toFixed(1) + '%';
                    document.getElementById('avgResponse').textContent = (1.0 + Math.random() * 0.5).toFixed(1) + 's';
                    document.getElementById('storageUsed').textContent = (40 + Math.random() * 20).toFixed(0) + 'GB';
                }
            }

            // Chart Initialization
            async initializeDashboardCharts() {
                await Promise.all([
                    this.createUserGrowthChart(),
                    this.createUserDistributionChart()
                ]);
            }

            async createUserGrowthChart() {
                const ctx = document.getElementById('userGrowthChart');
                if (!ctx) return;

                try {
                    const response = await this.apiRequest('/admin/charts/user-growth');
                    const data = response.data;

                    this.charts.userGrowth = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: data.labels,
                            datasets: [{
                                label: 'Users',
                                data: data.values,
                                borderColor: '#247BA0',
                                backgroundColor: 'rgba(36, 123, 160, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    grid: {
                                        color: '#E2E8F0'
                                    }
                                },
                                x: {
                                    grid: {
                                        display: false
                                    }
                                }
                            }
                        }
                    });
                } catch (error) {
                    this.createDemoChart(ctx, 'line');
                }
            }

            async createUserDistributionChart() {
                const ctx = document.getElementById('userDistributionChart');
                if (!ctx) return;

                try {
                    const response = await this.apiRequest('/admin/charts/user-distribution');
                    const data = response.data;

                    this.charts.userDistribution = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: data.labels,
                            datasets: [{
                                data: data.values,
                                backgroundColor: [
                                    '#247BA0',
                                    '#10B981',
                                    '#F59E0B',
                                    '#EF4444'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                } catch (error) {
                    this.createDemoChart(ctx, 'doughnut');
                }
            }

            createDemoChart(ctx, type) {
                if (type === 'line') {
                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            datasets: [{
                                label: 'Users',
                                data: [65, 78, 90, 105, 120, 135],
                                borderColor: '#247BA0',
                                backgroundColor: 'rgba(36, 123, 160, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: {
                                y: { beginAtZero: true, grid: { color: '#E2E8F0' } },
                                x: { grid: { display: false } }
                            }
                        }
                    });
                } else if (type === 'doughnut') {
                    new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Students', 'Alumni', 'Pending', 'Others'],
                            datasets: [{
                                data: [248, 156, 12, 8],
                                backgroundColor: ['#247BA0', '#10B981', '#F59E0B', '#EF4444']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { position: 'bottom' } }
                        }
                    });
                }
            }

            // Students Management
            async loadStudentsData() {
                this.log('Loading students data...');

                try {
                    const response = await this.apiRequest('/admin/students');
                    this.renderStudentsTable(response.data);
                    document.getElementById('studentsTotal').textContent = response.totalCount || response.data.length;
                } catch (error) {
                    this.renderDemoStudents();
                }
            }

            renderStudentsTable(students) {
                const tbody = document.getElementById('studentsTableBody');

                if (students.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px; color: var(--gray-500);">No students found</td></tr>';
                    return;
                }

                tbody.innerHTML = students.map(student => `
                    <tr data-user-id="${student.id}">
                        <td>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div class="user-avatar">${this.getInitials(student.fullName)}</div>
                                <div>
                                    <div>${student.fullName}</div>
                                    <small style="color: var(--gray-500);">${student.email}</small>
                                </div>
                            </div>
                        </td>
                        <td>${student.course}</td>
                        <td>${this.formatYear(student.currentYear)}</td>
                        <td><span class="status-badge ${student.status}">${student.status}</span></td>
                        <td>${new Date(student.createdAt).toLocaleDateString()}</td>
                        <td>
                            <button class="btn-secondary btn-sm" onclick="adminDashboard.editUser('student', '${student.id}')">Edit</button>
                            <button class="btn-danger btn-sm" onclick="adminDashboard.deleteUser('student', '${student.id}')">Delete</button>
                        </td>
                    </tr>
                `).join('');
            }

            renderDemoStudents() {
                const demoStudents = [
                    {
                        id: 'student_1',
                        fullName: 'John Doe',
                        email: 'john.doe@college.edu',
                        course: 'B.Tech Computer Science',
                        currentYear: 3,
                        status: 'verified',
                        createdAt: '2024-01-15T00:00:00.000Z'
                    },
                    {
                        id: 'student_2',
                        fullName: 'Alice Smith',
                        email: 'alice.smith@college.edu',
                        course: 'B.Tech Information Technology',
                        currentYear: 2,
                        status: 'pending',
                        createdAt: '2024-03-22T00:00:00.000Z'
                    }
                ];

                this.renderStudentsTable(demoStudents);
                document.getElementById('studentsTotal').textContent = demoStudents.length;
            }

            // Alumni Management
            async loadAlumniData() {
                this.log('Loading alumni data...');

                try {
                    const response = await this.apiRequest('/admin/alumni');
                    this.renderAlumniTable(response.data);
                    document.getElementById('alumniTotal').textContent = response.totalCount || response.data.length;
                } catch (error) {
                    this.renderDemoAlumni();
                }
            }

            renderAlumniTable(alumni) {
                const tbody = document.getElementById('alumniTableBody');

                if (alumni.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px; color: var(--gray-500);">No alumni found</td></tr>';
                    return;
                }

                tbody.innerHTML = alumni.map(alum => `
                    <tr data-user-id="${alum.id}">
                        <td>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div class="user-avatar">${this.getInitials(alum.fullName)}</div>
                                <div>
                                    <div>${alum.fullName}</div>
                                    <small style="color: var(--gray-500);">${alum.email}</small>
                                </div>
                            </div>
                        </td>
                        <td>${alum.course}</td>
                        <td>${alum.passingYear}</td>
                        <td>${alum.currentRole || 'Not specified'}</td>
                        <td><span class="status-badge ${alum.status}">${alum.status}</span></td>
                        <td>
                            <button class="btn-secondary btn-sm" onclick="adminDashboard.editUser('alumni', '${alum.id}')">Edit</button>
                            <button class="btn-danger btn-sm" onclick="adminDashboard.deleteUser('alumni', '${alum.id}')">Delete</button>
                        </td>
                    </tr>
                `).join('');
            }

            renderDemoAlumni() {
                const demoAlumni = [
                    {
                        id: 'alumni_1',
                        fullName: 'Mike Brown',
                        email: 'mike.brown@company.com',
                        course: 'B.Tech Computer Science',
                        passingYear: 2020,
                        currentRole: 'Senior Software Engineer',
                        status: 'verified',
                        createdAt: '2020-06-15T00:00:00.000Z'
                    },
                    {
                        id: 'alumni_2',
                        fullName: 'Sarah Johnson',
                        email: 'sarah.johnson@startup.com',
                        course: 'MBA Finance',
                        passingYear: 2019,
                        currentRole: 'Product Manager',
                        status: 'verified',
                        createdAt: '2019-05-20T00:00:00.000Z'
                    }
                ];

                this.renderAlumniTable(demoAlumni);
                document.getElementById('alumniTotal').textContent = demoAlumni.length;
            }

            // Events Management
            async loadEventsData() {
                this.log('Loading events data...');

                try {
                    const response = await this.apiRequest('/admin/events');
                    this.renderEventsTable(response.data);
                    document.getElementById('eventsTotal').textContent = response.totalCount || response.data.length;
                } catch (error) {
                    this.renderDemoEvents();
                }
            }

            renderEventsTable(events) {
                const tbody = document.getElementById('eventsTableBody');

                if (events.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px; color: var(--gray-500);">No events found</td></tr>';
                    return;
                }

                tbody.innerHTML = events.map(event => `
                    <tr data-event-id="${event.id}">
                        <td>
                            <div>
                                <div style="font-weight: 600;">${event.title}</div>
                                <small style="color: var(--gray-500);">${event.description.substring(0, 50)}...</small>
                            </div>
                        </td>
                        <td>${event.host}</td>
                        <td>${new Date(event.datetime).toLocaleDateString()}</td>
                        <td>${event.attendees || 0}/${event.maxAttendees}</td>
                        <td><span class="status-badge ${event.status}">${event.status}</span></td>
                        <td>
                            <button class="btn-secondary btn-sm" onclick="adminDashboard.editEvent('${event.id}')">Edit</button>
                            <button class="btn-danger btn-sm" onclick="adminDashboard.cancelEvent('${event.id}')">Cancel</button>
                        </td>
                    </tr>
                `).join('');
            }

            renderDemoEvents() {
                const demoEvents = [
                    {
                        id: 'event_1',
                        title: 'Tech Career AMA',
                        description: 'Q&A session about tech careers with industry experts',
                        datetime: '2025-09-15T18:00:00',
                        maxAttendees: 50,
                        host: 'Mike Brown',
                        attendees: 45,
                        status: 'active'
                    },
                    {
                        id: 'event_2',
                        title: 'Resume Workshop',
                        description: 'How to build a winning resume that gets you hired',
                        datetime: '2025-09-18T17:00:00',
                        maxAttendees: 30,
                        host: 'Sarah Johnson',
                        attendees: 23,
                        status: 'active'
                    }
                ];

                this.renderEventsTable(demoEvents);
                document.getElementById('eventsTotal').textContent = demoEvents.length;
            }

            // Articles Management
            async loadArticlesData() {
                this.log('Loading articles data...');

                try {
                    const response = await this.apiRequest('/admin/articles');
                    this.renderArticlesTable(response.data);
                    document.getElementById('articlesTotal').textContent = response.totalCount || response.data.length;
                } catch (error) {
                    this.renderDemoArticles();
                }
            }

            renderArticlesTable(articles) {
                const tbody = document.getElementById('articlesTableBody');

                if (articles.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px; color: var(--gray-500);">No articles found</td></tr>';
                    return;
                }

                tbody.innerHTML = articles.map(article => `
                    <tr data-article-id="${article.id}">
                        <td>
                            <div>
                                <div style="font-weight: 600;">${article.title}</div>
                                <small style="color: var(--gray-500);">${article.summary || 'No summary available'}</small>
                            </div>
                        </td>
                        <td>${article.author}</td>
                        <td>${article.category}</td>
                        <td><span class="status-badge ${article.status}">${article.status}</span></td>
                        <td>${new Date(article.publishedDate || article.createdAt).toLocaleDateString()}</td>
                        <td>
                            <button class="btn-secondary btn-sm" onclick="adminDashboard.editArticle('${article.id}')">Edit</button>
                            <button class="btn-danger btn-sm" onclick="adminDashboard.deleteArticle('${article.id}')">Delete</button>
                        </td>
                    </tr>
                `).join('');
            }

            renderDemoArticles() {
                const demoArticles = [
                    {
                        id: 'article_1',
                        title: 'Breaking into Tech Industry',
                        summary: 'Complete guide for students wanting to start their tech career',
                        author: 'Mike Brown',
                        category: 'Career',
                        status: 'published',
                        publishedDate: '2025-09-10T00:00:00.000Z'
                    },
                    {
                        id: 'article_2',
                        title: 'Remote Work Best Practices',
                        summary: 'Essential tips for productive remote work',
                        author: 'Sarah Johnson',
                        category: 'Productivity',
                        status: 'published',
                        publishedDate: '2025-09-08T00:00:00.000Z'
                    }
                ];

                this.renderArticlesTable(demoArticles);
                document.getElementById('articlesTotal').textContent = demoArticles.length;
            }

            // Questions Management
            async loadQuestionsData() {
                this.log('Loading questions data...');

                try {
                    const response = await this.apiRequest('/admin/questions');
                    this.renderQuestionsTable(response.data);
                    document.getElementById('questionsTotal').textContent = response.totalCount || response.data.length;
                } catch (error) {
                    this.renderDemoQuestions();
                }
            }

            renderQuestionsTable(questions) {
                const tbody = document.getElementById('questionsTableBody');

                if (questions.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px; color: var(--gray-500);">No questions found</td></tr>';
                    return;
                }

                tbody.innerHTML = questions.map(question => `
                    <tr>
                        <td>
                            <div>
                                <div style="font-weight: 600;">${question.title}</div>
                                <small style="color: var(--gray-500);">${question.content.substring(0, 80)}...</small>
                            </div>
                        </td>
                        <td>${question.askedBy}</td>
                        <td>${question.answers || 0}</td>
                        <td>${question.category}</td>
                        <td>${new Date(question.createdAt || question.postedDate).toLocaleDateString()}</td>
                        <td>
                            <button class="btn-secondary btn-sm" onclick="adminDashboard.viewQuestion('${question.id}')">View</button>
                            <button class="btn-danger btn-sm" onclick="adminDashboard.moderateQuestion('${question.id}')">Moderate</button>
                        </td>
                    </tr>
                `).join('');
            }

            renderDemoQuestions() {
                const demoQuestions = [
                    {
                        id: 'question_1',
                        title: 'How to prepare for technical interviews?',
                        content: 'I have a technical interview coming up next week. What are some good resources and strategies?',
                        askedBy: 'John Doe',
                        answers: 5,
                        category: 'Career',
                        postedDate: '2025-09-14T00:00:00.000Z'
                    },
                    {
                        id: 'question_2',
                        title: 'Best programming languages to learn in 2025?',
                        content: 'As a beginner, which programming languages should I focus on learning first?',
                        askedBy: 'Alice Smith',
                        answers: 8,
                        category: 'Technology',
                        postedDate: '2025-09-13T00:00:00.000Z'
                    }
                ];

                this.renderQuestionsTable(demoQuestions);
                document.getElementById('questionsTotal').textContent = demoQuestions.length;
            }

            // Analytics Management
            async loadAnalyticsData() {
                this.log('Loading analytics data...');

                try {
                    const timeframe = document.getElementById('analyticsTimeframe').value;
                    const response = await this.apiRequest(`/admin/analytics?timeframe=${timeframe}`);
                    this.updateAnalyticsStats(response.data);
                    this.loadAnalyticsCharts(response.data);
                    this.loadTopContent(response.data.topContent);
                } catch (error) {
                    this.loadDemoAnalytics();
                }
            }

            updateAnalyticsStats(data = null) {
                if (data) {
                    document.getElementById('totalPageViews').textContent = data.pageViews.toLocaleString();
                    document.getElementById('uniqueVisitors').textContent = data.uniqueVisitors.toLocaleString();
                    document.getElementById('newRegistrations').textContent = data.newRegistrations;
                    document.getElementById('avgSessionTime').textContent = data.avgSessionTime;

                    document.getElementById('pageViewsTrend').textContent = data.trends.pageViews;
                    document.getElementById('visitorsTrend').textContent = data.trends.visitors;
                    document.getElementById('registrationsTrend').textContent = data.trends.registrations;
                    document.getElementById('sessionTrend').textContent = data.trends.sessionTime;
                } else {
                    // Demo data
                    document.getElementById('totalPageViews').textContent = '12,847';
                    document.getElementById('uniqueVisitors').textContent = '3,456';
                    document.getElementById('newRegistrations').textContent = '189';
                    document.getElementById('avgSessionTime').textContent = '4m 32s';

                    document.getElementById('pageViewsTrend').textContent = '+15.3% vs last period';
                    document.getElementById('visitorsTrend').textContent = '+8.7% vs last period';
                    document.getElementById('registrationsTrend').textContent = '+23.1% vs last period';
                    document.getElementById('sessionTrend').textContent = '-5.2% vs last period';
                }
            }

            loadDemoAnalytics() {
                this.updateAnalyticsStats();
                this.createAnalyticsCharts();
                this.loadTopContent();
            }

            async loadAnalyticsCharts(data = null) {
                await Promise.all([
                    this.createTrafficChart(data),
                    this.createEngagementChart(data),
                    this.createFeaturesChart(data)
                ]);
            }

            createAnalyticsCharts() {
                this.createTrafficChart();
                this.createEngagementChart();
                this.createFeaturesChart();
            }

            async createTrafficChart(data = null) {
                const ctx = document.getElementById('trafficChart');
                if (!ctx) return;

                const chartData = data?.traffic || {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Page Views',
                        data: [1200, 1900, 3000, 5000, 2000, 3000, 2500],
                        borderColor: '#247BA0',
                        backgroundColor: 'rgba(36, 123, 160, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'Unique Visitors',
                        data: [800, 1200, 1800, 2500, 1400, 1800, 1600],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    }]
                };

                this.charts.traffic = new Chart(ctx, {
                    type: 'line',
                    data: chartData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: '#E2E8F0'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }

            async createEngagementChart(data = null) {
                const ctx = document.getElementById('engagementChart');
                if (!ctx) return;

                const chartData = data?.engagement || {
                    labels: ['Articles', 'Events', 'Q&A', 'Forums'],
                    datasets: [{
                        data: [45, 25, 20, 10],
                        backgroundColor: ['#247BA0', '#10B981', '#F59E0B', '#EF4444']
                    }]
                };

                this.charts.engagement = new Chart(ctx, {
                    type: 'doughnut',
                    data: chartData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            async createFeaturesChart(data = null) {
                const ctx = document.getElementById('featuresChart');
                if (!ctx) return;

                const chartData = data?.features || {
                    labels: ['Profile', 'Events', 'Articles', 'Q&A', 'Alumni Network'],
                    datasets: [{
                        label: 'Usage',
                        data: [65, 59, 80, 81, 56],
                        backgroundColor: 'rgba(36, 123, 160, 0.8)',
                        borderColor: '#247BA0',
                        borderWidth: 1
                    }]
                };

                this.charts.features = new Chart(ctx, {
                    type: 'bar',
                    data: chartData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: '#E2E8F0'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }

            loadTopContent(data = null) {
                const topContent = data || [
                    { title: 'Breaking into Tech Industry', type: 'Article', views: 1247, engagement: '87%', performance: 'high' },
                    { title: 'Career AMA Session', type: 'Event', views: 892, engagement: '92%', performance: 'high' },
                    { title: 'How to prepare for interviews?', type: 'Question', views: 634, engagement: '78%', performance: 'medium' },
                    { title: 'Remote Work Guidelines', type: 'Article', views: 521, engagement: '65%', performance: 'medium' },
                    { title: 'Alumni Networking Event', type: 'Event', views: 445, engagement: '83%', performance: 'high' }
                ];

                const tbody = document.getElementById('topContentTable');
                tbody.innerHTML = topContent.map(content => `
                    <tr>
                        <td>${content.title}</td>
                        <td>${content.type}</td>
                        <td>${content.views}</td>
                        <td>${content.engagement}</td>
                        <td><span class="status-badge ${content.performance === 'high' ? 'verified' : 'pending'}">${content.performance}</span></td>
                    </tr>
                `).join('');
            }

            // Reports Management
            async loadReportsData() {
                this.log('Loading reports data...');

                try {
                    const response = await this.apiRequest('/admin/reports');
                    this.renderRecentReports(response.data);
                } catch (error) {
                    this.renderDemoReports();
                }
            }

            renderRecentReports(reports) {
                const tbody = document.getElementById('recentReportsTable');

                if (reports.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 20px; color: var(--gray-500);">No reports generated yet</td></tr>';
                    return;
                }

                tbody.innerHTML = reports.map(report => `
                    <tr>
                        <td>${report.name}</td>
                        <td>${report.type}</td>
                        <td>${new Date(report.generatedAt).toLocaleDateString()}</td>
                        <td><span class="status-badge verified">${report.status}</span></td>
                        <td>
                            <button class="btn-secondary btn-sm" onclick="adminDashboard.downloadReportPDF('${report.id}')">
                                <i class="fas fa-download"></i>
                                Download
                            </button>
                            <button class="btn-primary btn-sm" onclick="adminDashboard.shareReport('${report.id}')">
                                <i class="fas fa-share"></i>
                                Share
                            </button>
                        </td>
                    </tr>
                `).join('');
            }

            renderDemoReports() {
                const demoReports = [
                    { id: '1', name: 'Monthly User Activity', type: 'User', generatedAt: '2025-09-14', status: 'completed' },
                    { id: '2', name: 'Event Engagement Analysis', type: 'Engagement', generatedAt: '2025-09-13', status: 'completed' },
                    { id: '3', name: 'Verification Queue Report', type: 'Verification', generatedAt: '2025-09-12', status: 'completed' },
                    { id: '4', name: 'Content Performance Summary', type: 'Content', generatedAt: '2025-09-11', status: 'completed' },
                    { id: '5', name: 'System Health Check', type: 'System', generatedAt: '2025-09-10', status: 'completed' }
                ];

                this.renderRecentReports(demoReports);
            }

            async loadSettingsData() {
                this.log('Loading settings data...');
                // Settings are loaded in loadSettings method
            }

            // Verification Management
            async loadVerificationRequests() {
                try {
                    const response = await this.apiRequest('/admin/verification-requests');
                    this.renderVerificationRequests(response.data);
                    this.updatePendingCount(response.data.length);
                } catch (error) {
                    // Demo mode - load sample data
                    const pendingRequests = [
                        {
                            id: 'v' + Date.now(),
                            studentId: 'student_' + Date.now(),
                            fullName: 'John Doe',
                            course: 'B.Tech',
                            branch: 'Computer Science',
                            currentYear: 3,
                            enrollmentNo: '2022CSE001',
                            collegeName: 'Sample University',
                            collegeEmail: 'john.doe@sample.edu',
                            submittedAt: new Date().toISOString()
                        }
                    ];
                    this.renderVerificationRequests(pendingRequests);
                    this.updatePendingCount(pendingRequests.length);
                }
            }

            renderVerificationRequests(requests) {
                const container = document.getElementById('verificationContainer');

                if (requests.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: var(--gray-500); padding: 40px;">No pending verification requests</p>';
                    return;
                }

                const html = requests.map(request => `
                    <div class="verification-card">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                            <div>
                                <h3 style="color: var(--gray-900); margin-bottom: 5px;">${request.fullName}</h3>
                                <p style="color: var(--gray-600); font-size: 0.9rem;">${request.course} - ${request.branch}</p>
                                <p style="color: var(--gray-500); font-size: 0.85rem;">${request.collegeName}</p>
                            </div>
                            <div style="text-align: right;">
                                <span class="status-badge pending">Pending Review</span>
                                <p style="color: var(--gray-500); font-size: 0.8rem; margin-top: 5px;">
                                    Submitted: ${new Date(request.submittedAt).toLocaleDateString()}
                                </p>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn-primary btn-sm" onclick="adminDashboard.viewVerificationDetails('${request.id}')">
                                <i class="fas fa-eye"></i>
                                Review Details
                            </button>
                            <button class="btn-success btn-sm" onclick="adminDashboard.quickApprove('${request.id}')">
                                <i class="fas fa-check"></i>
                                Quick Approve
                            </button>
                            <button class="btn-danger btn-sm" onclick="adminDashboard.showRejectModal('${request.id}')">
                                <i class="fas fa-times"></i>
                                Reject
                            </button>
                        </div>
                    </div>
                `).join('');

                container.innerHTML = html;
            }

            viewVerificationDetails(requestId) {
                // For demo purposes, create a sample request
                const request = {
                    id: requestId,
                    fullName: 'John Doe',
                    enrollmentNo: '2022CSE001',
                    course: 'B.Tech',
                    branch: 'Computer Science',
                    currentYear: 3,
                    collegeEmail: 'john.doe@sample.edu',
                    collegeName: 'Sample University',
                    submittedAt: new Date().toISOString()
                };

                this.currentVerification = request;

                const detailsHTML = `
                    <div style="background: var(--gray-50); border-radius: var(--radius-lg); padding: 20px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div><strong>Full Name:</strong><br>${request.fullName}</div>
                            <div><strong>Enrollment No:</strong><br>${request.enrollmentNo}</div>
                            <div><strong>Course:</strong><br>${request.course}</div>
                            <div><strong>Branch:</strong><br>${request.branch}</div>
                            <div><strong>Current Year:</strong><br>${request.currentYear}</div>
                            <div><strong>College Email:</strong><br>${request.collegeEmail}</div>
                        </div>
                        <div style="margin-top: 15px;">
                            <strong>College/University:</strong><br>${request.collegeName}
                        </div>
                        <div style="margin-top: 15px;">
                            <strong>Submitted:</strong><br>${new Date(request.submittedAt).toLocaleString()}
                        </div>
                    </div>
                `;

                document.getElementById('verificationDetails').innerHTML = detailsHTML;
                document.getElementById('verificationModal').classList.remove('hidden');
            }

            async quickApprove(requestId) {
                this.currentVerification = { id: requestId };
                await this.approveVerification();
            }

            async approveVerification() {
                if (!this.currentVerification) return;

                const btn = document.getElementById('approveBtn');
                this.setLoading(btn, true);

                try {
                    await this.apiRequest(`/admin/verify-student`, {
                        method: 'POST',
                        body: JSON.stringify({
                            studentId: this.currentVerification.studentId || this.currentVerification.id,
                            action: 'approve'
                        })
                    });

                    this.showSuccess('Student verification approved successfully!');
                } catch (error) {
                    this.showSuccess('Student verification approved! (Demo mode)');
                }

                this.closeModal('verificationModal');
                this.loadVerificationRequests();
                this.updateDashboardStats();
                this.currentVerification = null;
                this.setLoading(btn, false);
            }

            showRejectModal(requestId = null) {
                if (requestId) {
                    this.currentVerification = { id: requestId };
                }
                document.getElementById('rejectionModal').classList.remove('hidden');
            }

            async rejectVerification() {
                const reason = document.getElementById('rejectionReason').value.trim();
                if (!reason) {
                    this.showError('Please provide a reason for rejection');
                    return;
                }

                if (!this.currentVerification) return;

                const btn = document.querySelector('#rejectionModal .btn-danger');
                this.setLoading(btn, true);

                try {
                    await this.apiRequest(`/admin/verify-student`, {
                        method: 'POST',
                        body: JSON.stringify({
                            studentId: this.currentVerification.studentId || this.currentVerification.id,
                            action: 'reject',
                            reason: reason
                        })
                    });

                    this.showSuccess('Student verification rejected.');
                } catch (error) {
                    this.showSuccess('Student verification rejected! (Demo mode)');
                }

                this.closeModal('rejectionModal');
                this.closeModal('verificationModal');
                this.loadVerificationRequests();
                this.updateDashboardStats();
                this.currentVerification = null;

                document.getElementById('rejectionReason').value = '';
                this.setLoading(btn, false);
            }

            refreshVerifications() {
                this.loadVerificationRequests();
                this.updateDashboardStats();
            }

            updatePendingCount(count) {
                const badge = document.getElementById('verificationCount');
                if (badge) {
                    badge.textContent = count;
                    badge.style.display = count > 0 ? 'inline' : 'none';
                }

                const pendingCountElement = document.getElementById('pendingCount');
                if (pendingCountElement) {
                    pendingCountElement.textContent = count;
                }
            }

            // User Management Functions
            async handleUserSubmission(e) {
                e.preventDefault();
                const btn = e.target.querySelector('button[type="submit"]');
                this.setLoading(btn, true);

                try {
                    const formData = new FormData(e.target);
                    const userData = {
                        fullName: formData.get('fullName'),
                        email: formData.get('email'),
                        role: formData.get('role'),
                        course: formData.get('course'),
                        year: formData.get('year'),
                        phone: formData.get('phone')
                    };

                    await this.apiRequest('/admin/users', {
                        method: 'POST',
                        body: JSON.stringify(userData)
                    });

                    this.showSuccess(`${userData.role} added successfully!`);
                    this.closeModal('userModal');
                    e.target.reset();

                    if (this.currentView === 'students' || this.currentView === 'alumni') {
                        this.loadViewData(this.currentView);
                    }
                    this.updateDashboardStats();

                } catch (error) {
                    this.showError('Failed to save user. Please try again.');
                    console.error('User submission error:', error);
                } finally {
                    this.setLoading(btn, false);
                }
            }

            async handleEventSubmission(e) {
                e.preventDefault();
                const btn = e.target.querySelector('button[type="submit"]');
                this.setLoading(btn, true);

                try {
                    const formData = new FormData(e.target);
                    const eventData = {
                        title: formData.get('title'),
                        description: formData.get('description'),
                        datetime: formData.get('datetime'),
                        maxAttendees: parseInt(formData.get('maxAttendees')),
                        host: formData.get('host') || 'Admin',
                        location: formData.get('location')
                    };

                    await this.apiRequest('/admin/events', {
                        method: 'POST',
                        body: JSON.stringify(eventData)
                    });

                    this.showSuccess('Event created successfully!');
                    this.closeModal('eventModal');
                    e.target.reset();

                    if (this.currentView === 'events') {
                        this.loadEventsData();
                    }
                    this.updateDashboardStats();

                } catch (error) {
                    this.showError('Failed to create event. Please try again.');
                    console.error('Event submission error:', error);
                } finally {
                    this.setLoading(btn, false);
                }
            }

            async handleProfileSubmission(e) {
                e.preventDefault();
                const btn = e.target.querySelector('button[type="submit"]');
                this.setLoading(btn, true);

                try {
                    const formData = new FormData(e.target);
                    const profileData = {
                        fullName: formData.get('fullName'),
                        email: formData.get('email'),
                        phone: formData.get('phone'),
                        newPassword: formData.get('newPassword')
                    };

                    // Validate password confirmation
                    if (profileData.newPassword) {
                        const confirmPassword = formData.get('confirmPassword');
                        if (profileData.newPassword !== confirmPassword) {
                            this.showError('Passwords do not match');
                            return;
                        }
                    }

                    await this.apiRequest('/admin/profile', {
                        method: 'PUT',
                        body: JSON.stringify(profileData)
                    });

                    this.showSuccess('Profile updated successfully!');
                    this.closeModal('profileModal');

                    // Update UI with new profile data
                    document.getElementById('dropdownName').textContent = profileData.fullName;
                    document.getElementById('dropdownEmail').textContent = profileData.email;

                } catch (error) {
                    this.showError('Failed to update profile. Please try again.');
                    console.error('Profile update error:', error);
                } finally {
                    this.setLoading(btn, false);
                }
            }

            updateUserForm(role) {
                const yearLabel = document.getElementById('yearLabel');
                const yearGroup = document.getElementById('yearGroup');

                if (role === 'alumni') {
                    yearLabel.textContent = 'Passing Year';
                    yearGroup.querySelector('input').min = '1980';
                    yearGroup.querySelector('input').max = '2025';
                    yearGroup.querySelector('input').placeholder = 'e.g., 2020';
                } else {
                    yearLabel.textContent = 'Current Year';
                    yearGroup.querySelector('input').min = '1';
                    yearGroup.querySelector('input').max = '5';
                    yearGroup.querySelector('input').placeholder = 'e.g., 3';
                }
            }

            async editUser(type, userId) {
                try {
                    const response = await this.apiRequest(`/admin/users/${userId}`);
                    // Populate edit form with user data
                    this.showSuccess(`Edit functionality for ${response.data.fullName} will be implemented`);
                } catch (error) {
                    this.showError('User not found');
                }
            }

            async deleteUser(type, userId) {
                if (!confirm('Are you sure you want to delete this user?')) return;

                try {
                    await this.apiRequest(`/admin/users/${userId}`, {
                        method: 'DELETE'
                    });

                    this.showSuccess('User deleted successfully');
                    this.loadViewData(this.currentView);
                    this.updateDashboardStats();
                } catch (error) {
                    this.showError('Failed to delete user');
                }
            }

            async editEvent(eventId) {
                this.showSuccess('Event editing functionality will be implemented');
            }

            async cancelEvent(eventId) {
                if (!confirm('Are you sure you want to cancel this event?')) return;

                try {
                    await this.apiRequest(`/admin/events/${eventId}`, {
                        method: 'PATCH',
                        body: JSON.stringify({ status: 'cancelled' })
                    });

                    this.showSuccess('Event cancelled successfully');
                    this.loadEventsData();
                } catch (error) {
                    this.showError('Failed to cancel event');
                }
            }

            async editArticle(articleId) {
                this.showSuccess('Article editing functionality will be implemented');
            }

            async deleteArticle(articleId) {
                if (!confirm('Are you sure you want to delete this article?')) return;

                try {
                    await this.apiRequest(`/admin/articles/${articleId}`, {
                        method: 'DELETE'
                    });

                    this.showSuccess('Article deleted successfully');
                    this.loadArticlesData();
                } catch (error) {
                    this.showError('Failed to delete article');
                }
            }

            async viewQuestion(questionId) {
                this.showSuccess('Question viewer will be implemented');
            }

            async moderateQuestion(questionId) {
                this.showSuccess('Question moderation will be implemented');
            }

            // Settings Management
            toggleSetting(toggle, settingKey) {
                toggle.classList.toggle('active');
                this.settings[settingKey] = toggle.classList.contains('active');
                this.log(`Setting ${settingKey} changed to ${this.settings[settingKey]}`);
            }

            async saveAllSettings() {
                try {
                    // Get all form values
                    this.settings.platformName = document.getElementById('platformName').value;
                    this.settings.sessionTimeout = parseInt(document.getElementById('sessionTimeout').value);
                    this.settings.loginAttemptLimit = parseInt(document.getElementById('loginAttemptLimit').value);
                    this.settings.fileUploadLimit = parseInt(document.getElementById('fileUploadLimit').value);

                    await this.apiRequest('/admin/settings', {
                        method: 'PUT',
                        body: JSON.stringify(this.settings)
                    });

                    this.showSuccess('Settings saved successfully!');
                } catch (error) {
                    this.showError('Failed to save settings');
                }
            }

            backupSettings() {
                const settingsBackup = {
                    settings: this.settings,
                    timestamp: new Date().toISOString(),
                    version: '1.0'
                };

                const dataStr = JSON.stringify(settingsBackup, null, 2);
                this.downloadFile(dataStr, `realm-settings-backup-${new Date().toISOString().split('T')[0]}.json`, 'application/json');

                this.showSuccess('Settings backup downloaded!');
            }

            // PDF Generation Functions
            async exportDashboardPDF() {
                this.showLoading('Generating dashboard PDF...');

                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();

                    // Title
                    doc.setFontSize(20);
                    doc.setTextColor(19, 41, 61);
                    doc.text('Admin Dashboard Report', 20, 30);

                    // Date
                    doc.setFontSize(12);
                    doc.setTextColor(100);
                    doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 20, 45);

                    // Stats
                    doc.setFontSize(14);
                    doc.setTextColor(0);
                    doc.text('Platform Statistics', 20, 65);

                    const stats = [
                        ['Total Users', document.getElementById('totalUsersCount').textContent],
                        ['Pending Verifications', document.getElementById('pendingVerificationsCount').textContent],
                        ['Active Events', document.getElementById('activeEventsCount').textContent],
                        ['Platform Activity', document.getElementById('platformActivity').textContent]
                    ];

                    doc.autoTable({
                        startY: 75,
                        head: [['Metric', 'Value']],
                        body: stats,
                        theme: 'striped',
                        headStyles: { fillColor: [36, 123, 160] }
                    });

                    // System Health
                    doc.text('System Health', 20, doc.lastAutoTable.finalY + 20);

                    const healthStats = [
                        ['Uptime', document.getElementById('systemUptime').textContent],
                        ['Average Response Time', document.getElementById('avgResponse').textContent],
                        ['Storage Used', document.getElementById('storageUsed').textContent]
                    ];

                    doc.autoTable({
                        startY: doc.lastAutoTable.finalY + 30,
                        head: [['Metric', 'Value']],
                        body: healthStats,
                        theme: 'striped',
                        headStyles: { fillColor: [16, 185, 129] }
                    });

                    doc.save('realm-dashboard-report.pdf');
                    this.showSuccess('Dashboard PDF exported successfully!');
                } catch (error) {
                    this.showError('Failed to generate PDF');
                } finally {
                    this.hideLoading();
                }
            }

            async exportAnalyticsPDF() {
                this.showLoading('Generating analytics PDF...');

                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();

                    doc.setFontSize(20);
                    doc.setTextColor(19, 41, 61);
                    doc.text('Analytics Report', 20, 30);

                    doc.setFontSize(12);
                    doc.setTextColor(100);
                    doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 20, 45);
                    doc.text(`Timeframe: ${document.getElementById('analyticsTimeframe').options[document.getElementById('analyticsTimeframe').selectedIndex].text}`, 20, 55);

                    const analyticsStats = [
                        ['Page Views', document.getElementById('totalPageViews').textContent],
                        ['Unique Visitors', document.getElementById('uniqueVisitors').textContent],
                        ['New Registrations', document.getElementById('newRegistrations').textContent],
                        ['Average Session Time', document.getElementById('avgSessionTime').textContent]
                    ];

                    doc.autoTable({
                        startY: 70,
                        head: [['Metric', 'Value']],
                        body: analyticsStats,
                        theme: 'striped',
                        headStyles: { fillColor: [36, 123, 160] }
                    });

                    doc.save('realm-analytics-report.pdf');
                    this.showSuccess('Analytics PDF exported successfully!');
                } catch (error) {
                    this.showError('Failed to generate PDF');
                } finally {
                    this.hideLoading();
                }
            }

            async generateReportPDF(type) {
                this.showLoading(`Generating ${type} report PDF...`);

                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();

                    doc.setFontSize(20);
                    doc.setTextColor(19, 41, 61);
                    doc.text(`${type.charAt(0).toUpperCase() + type.slice(1)} Report`, 20, 30);

                    doc.setFontSize(12);
                    doc.setTextColor(100);
                    doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 20, 45);

                    const reportData = await this.getReportData(type);

                    if (reportData && Object.keys(reportData).length > 0) {
                        const dataArray = Object.entries(reportData).map(([key, value]) => [
                            key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase()),
                            value.toString()
                        ]);

                        doc.autoTable({
                            startY: 60,
                            head: [['Metric', 'Value']],
                            body: dataArray,
                            theme: 'striped',
                            headStyles: { fillColor: [36, 123, 160] }
                        });
                    }

                    doc.save(`realm-${type}-report-${new Date().toISOString().split('T')[0]}.pdf`);
                    this.showSuccess(`${type} report PDF generated successfully!`);
                } catch (error) {
                    this.showError('Failed to generate PDF report');
                } finally {
                    this.hideLoading();
                }
            }

            async exportStudentsPDF() {
                this.showLoading('Generating students PDF...');

                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF('l'); // Landscape

                    doc.setFontSize(20);
                    doc.setTextColor(19, 41, 61);
                    doc.text('Students Report', 20, 30);

                    doc.setFontSize(12);
                    doc.setTextColor(100);
                    doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 20, 45);

                    // Get students data from current table
                    const rows = Array.from(document.querySelectorAll('#studentsTableBody tr')).map(row => {
                        const cells = row.querySelectorAll('td');
                        if (cells.length >= 5) {
                            return [
                                cells[0].textContent.trim().split('\n')[0], // Name only
                                cells[1].textContent.trim(),
                                cells[2].textContent.trim(),
                                cells[3].textContent.trim(),
                                cells[4].textContent.trim()
                            ];
                        }
                        return null;
                    }).filter(row => row !== null);

                    if (rows.length > 0) {
                        doc.autoTable({
                            startY: 60,
                            head: [['Name', 'Course', 'Year', 'Status', 'Joined']],
                            body: rows,
                            theme: 'striped',
                            headStyles: { fillColor: [36, 123, 160] },
                            styles: { fontSize: 10 }
                        });
                    }

                    doc.save('realm-students-report.pdf');
                    this.showSuccess('Students PDF exported successfully!');
                } catch (error) {
                    this.showError('Failed to generate PDF');
                } finally {
                    this.hideLoading();
                }
            }

            async exportAlumniPDF() {
                this.showLoading('Generating alumni PDF...');

                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF('l');

                    doc.setFontSize(20);
                    doc.setTextColor(19, 41, 61);
                    doc.text('Alumni Report', 20, 30);

                    doc.setFontSize(12);
                    doc.setTextColor(100);
                    doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 20, 45);

                    const rows = Array.from(document.querySelectorAll('#alumniTableBody tr')).map(row => {
                        const cells = row.querySelectorAll('td');
                        if (cells.length >= 5) {
                            return [
                                cells[0].textContent.trim().split('\n')[0],
                                cells[1].textContent.trim(),
                                cells[2].textContent.trim(),
                                cells[3].textContent.trim(),
                                cells[4].textContent.trim()
                            ];
                        }
                        return null;
                    }).filter(row => row !== null);

                    if (rows.length > 0) {
                        doc.autoTable({
                            startY: 60,
                            head: [['Name', 'Course', 'Passing Year', 'Current Role', 'Status']],
                            body: rows,
                            theme: 'striped',
                            headStyles: { fillColor: [36, 123, 160] },
                            styles: { fontSize: 10 }
                        });
                    }

                    doc.save('realm-alumni-report.pdf');
                    this.showSuccess('Alumni PDF exported successfully!');
                } catch (error) {
                    this.showError('Failed to generate PDF');
                } finally {
                    this.hideLoading();
                }
            }

            async exportEventsPDF() {
                this.showLoading('Generating events PDF...');

                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF('l');

                    doc.setFontSize(20);
                    doc.setTextColor(19, 41, 61);
                    doc.text('Events Report', 20, 30);

                    doc.setFontSize(12);
                    doc.setTextColor(100);
                    doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 20, 45);

                    const rows = Array.from(document.querySelectorAll('#eventsTableBody tr')).map(row => {
                        const cells = row.querySelectorAll('td');
                        if (cells.length >= 5) {
                            return [
                                cells[0].textContent.trim().split('\n')[0],
                                cells[1].textContent.trim(),
                                cells[2].textContent.trim(),
                                cells[3].textContent.trim(),
                                cells[4].textContent.trim()
                            ];
                        }
                        return null;
                    }).filter(row => row !== null);

                    if (rows.length > 0) {
                        doc.autoTable({
                            startY: 60,
                            head: [['Event', 'Host', 'Date', 'Attendees', 'Status']],
                            body: rows,
                            theme: 'striped',
                            headStyles: { fillColor: [36, 123, 160] },
                            styles: { fontSize: 10 }
                        });
                    }

                    doc.save('realm-events-report.pdf');
                    this.showSuccess('Events PDF exported successfully!');
                } catch (error) {
                    this.showError('Failed to generate PDF');
                } finally {
                    this.hideLoading();
                }
            }

            async exportArticlesPDF() {
                this.showLoading('Generating articles PDF...');

                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF('l');

                    doc.setFontSize(20);
                    doc.setTextColor(19, 41, 61);
                    doc.text('Articles Report', 20, 30);

                    doc.setFontSize(12);
                    doc.setTextColor(100);
                    doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 20, 45);

                    const rows = Array.from(document.querySelectorAll('#articlesTableBody tr')).map(row => {
                        const cells = row.querySelectorAll('td');
                        if (cells.length >= 5) {
                            return [
                                cells[0].textContent.trim().split('\n')[0],
                                cells[1].textContent.trim(),
                                cells[2].textContent.trim(),
                                cells[3].textContent.trim(),
                                cells[4].textContent.trim()
                            ];
                        }
                        return null;
                    }).filter(row => row !== null);

                    if (rows.length > 0) {
                        doc.autoTable({
                            startY: 60,
                            head: [['Article', 'Author', 'Category', 'Status', 'Published']],
                            body: rows,
                            theme: 'striped',
                            headStyles: { fillColor: [36, 123, 160] },
                            styles: { fontSize: 10 }
                        });
                    }

                    doc.save('realm-articles-report.pdf');
                    this.showSuccess('Articles PDF exported successfully!');
                } catch (error) {
                    this.showError('Failed to generate PDF');
                } finally {
                    this.hideLoading();
                }
            }

            async exportQuestionsPDF() {
                this.showLoading('Generating questions PDF...');

                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF('l');

                    doc.setFontSize(20);
                    doc.setTextColor(19, 41, 61);
                    doc.text('Q&A Report', 20, 30);

                    doc.setFontSize(12);
                    doc.setTextColor(100);
                    doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 20, 45);

                    const rows = Array.from(document.querySelectorAll('#questionsTableBody tr')).map(row => {
                        const cells = row.querySelectorAll('td');
                        if (cells.length >= 5) {
                            return [
                                cells[0].textContent.trim().split('\n')[0],
                                cells[1].textContent.trim(),
                                cells[2].textContent.trim(),
                                cells[3].textContent.trim(),
                                cells[4].textContent.trim()
                            ];
                        }
                        return null;
                    }).filter(row => row !== null);

                    if (rows.length > 0) {
                        doc.autoTable({
                            startY: 60,
                            head: [['Question', 'Asked By', 'Answers', 'Category', 'Posted']],
                            body: rows,
                            theme: 'striped',
                            headStyles: { fillColor: [36, 123, 160] },
                            styles: { fontSize: 10 }
                        });
                    }

                    doc.save('realm-questions-report.pdf');
                    this.showSuccess('Questions PDF exported successfully!');
                } catch (error) {
                    this.showError('Failed to generate PDF');
                } finally {
                    this.hideLoading();
                }
            }

            // Notification Management
            async loadNotifications() {
                try {
                    const response = await this.apiRequest('/admin/notifications');
                    this.notifications = response.data;
                    this.updateNotificationBadge();
                    this.renderNotifications();
                } catch (error) {
                    // Demo notifications
                    this.notifications = [
                        {
                            id: '1',
                            title: 'New Verification Request',
                            message: 'John Doe submitted a verification request',
                            timestamp: new Date(Date.now() - 10 * 60 * 1000),
                            read: false,
                            type: 'verification'
                        },
                        {
                            id: '2',
                            title: 'System Alert',
                            message: 'Server response time increased',
                            timestamp: new Date(Date.now() - 30 * 60 * 1000),
                            read: false,
                            type: 'system'
                        },
                        {
                            id: '3',
                            title: 'New User Registration',
                            message: 'Alice Smith registered as a student',
                            timestamp: new Date(Date.now() - 60 * 60 * 1000),
                            read: true,
                            type: 'user'
                        }
                    ];
                    this.updateNotificationBadge();
                    this.renderNotifications();
                }
            }

            updateNotificationBadge() {
                const unreadCount = this.notifications.filter(n => !n.read).length;
                const badge = document.getElementById('notificationBadge');
                badge.textContent = unreadCount;
                badge.style.display = unreadCount > 0 ? 'block' : 'none';
            }

            renderNotifications() {
                const list = document.getElementById('notificationList');

                if (this.notifications.length === 0) {
                    list.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--gray-500);">No notifications</div>';
                    return;
                }

                list.innerHTML = this.notifications.map(notification => `
                    <div class="notification-item ${notification.read ? '' : 'unread'}" onclick="adminDashboard.handleNotificationClick('${notification.id}')">
                        <div class="notification-title">${notification.title}</div>
                        <div class="notification-text">${notification.message}</div>
                        <div class="notification-time">${this.timeAgo(notification.timestamp)}</div>
                    </div>
                `).join('');
            }

            toggleNotificationPanel() {
                const panel = document.getElementById('notificationPanel');
                panel.classList.toggle('show');
            }

            hideNotificationPanel() {
                const panel = document.getElementById('notificationPanel');
                panel.classList.remove('show');
            }

            async handleNotificationClick(notificationId) {
                const notification = this.notifications.find(n => n.id === notificationId);
                if (!notification) return;

                // Mark as read
                if (!notification.read) {
                    notification.read = true;
                    this.updateNotificationBadge();
                    this.renderNotifications();
                }

                // Navigate based on notification type
                switch (notification.type) {
                    case 'verification':
                        this.switchView('verifications');
                        break;
                    case 'user':
                        this.switchView('students');
                        break;
                    case 'system':
                        this.switchView('dashboard');
                        break;
                }

                this.hideNotificationPanel();
            }

            async markAllNotificationsRead() {
                this.notifications.forEach(n => n.read = true);
                this.updateNotificationBadge();
                this.renderNotifications();

                try {
                    await this.apiRequest('/admin/notifications/mark-all-read', {
                        method: 'POST'
                    });
                } catch (error) {
                    // Handle silently for demo
                }
            }

            // Filter Management
            toggleFilter(type) {
                const filterPanel = document.getElementById(`${type}Filter`);
                if (filterPanel) {
                    filterPanel.classList.toggle('show');
                }
            }

            applyFilters(type) {
                // Apply filters based on type
                this.loadViewData(type);
                this.showSuccess('Filters applied');
            }

            clearFilters(type) {
                // Clear all filter inputs
                const filterPanel = document.getElementById(`${type}Filter`);
                if (filterPanel) {
                    const selects = filterPanel.querySelectorAll('select');
                    selects.forEach(select => select.selectedIndex = 0);
                }
                this.loadViewData(type);
                this.showSuccess('Filters cleared');
            }

            // Utility Functions
            toggleProfileDropdown() {
                const dropdown = document.getElementById('profileDropdown');
                if (dropdown) {
                    dropdown.classList.toggle('show');
                }
            }

            closeProfileDropdown() {
                const dropdown = document.getElementById('profileDropdown');
                if (dropdown) {
                    dropdown.classList.remove('show');
                }
            }

            openProfileSettings() {
                this.closeProfileDropdown();
                document.getElementById('profileModal').classList.remove('hidden');
            }

            closeModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('hidden');
                    modal.querySelectorAll('.btn-primary, .btn-success, .btn-danger').forEach(btn => {
                        this.setLoading(btn, false);
                    });
                }
            }

            closeAllModals() {
                document.querySelectorAll('.modal-overlay').forEach(modal => {
                    modal.classList.add('hidden');
                });
            }

            setLoading(button, loading) {
                if (!button) return;

                const spinner = button.querySelector('.spinner');
                const text = button.querySelector('.btn-text') || button;

                if (loading) {
                    button.disabled = true;
                    button.classList.add('loading');
                    if (spinner) spinner.style.display = 'inline-block';
                    if (text !== button) text.style.opacity = '0.7';
                } else {
                    button.disabled = false;
                    button.classList.remove('loading');
                    if (spinner) spinner.style.display = 'none';
                    if (text !== button) text.style.opacity = '1';
                }
            }

            showLoading(message) {
                // Show global loading indicator
                const loading = document.createElement('div');
                loading.id = 'globalLoading';
                loading.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 3000;
                    backdrop-filter: blur(4px);
                `;
                loading.innerHTML = `
                    <div style="background: var(--white); padding: 30px; border-radius: var(--radius-lg); text-align: center; box-shadow: var(--shadow-xl);">
                        <div class="spinner" style="margin: 0 auto 15px; display: block; width: 30px; height: 30px;"></div>
                        <div style="color: var(--gray-700); font-weight: 500;">${message}</div>
                    </div>
                `;
                document.body.appendChild(loading);
            }

            hideLoading() {
                const loading = document.getElementById('globalLoading');
                if (loading) {
                    loading.remove();
                }
            }

            showSuccess(message) {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--success);
                    color: white;
                    padding: 15px 20px;
                    border-radius: var(--radius-lg);
                    z-index: 2000;
                    box-shadow: var(--shadow-xl);
                    font-weight: 500;
                    max-width: 300px;
                `;
                notification.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-check-circle"></i>
                        <span>${message}</span>
                    </div>
                `;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.remove();
                }, 5000);
            }

            showError(message) {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--error);
                    color: white;
                    padding: 15px 20px;
                    border-radius: var(--radius-lg);
                    z-index: 2000;
                    box-shadow: var(--shadow-xl);
                    font-weight: 500;
                    max-width: 300px;
                `;
                notification.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>${message}</span>
                    </div>
                `;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.remove();
                }, 5000);
            }

            getInitials(name) {
                return name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
            }

            formatYear(year) {
                if (!year) return '';
                const suffixes = { 1: 'st', 2: 'nd', 3: 'rd' };
                return `${year}${suffixes[year] || 'th'} Year`;
            }

            downloadFile(content, filename, contentType) {
                const blob = new Blob([content], { type: contentType });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }

            async getReportData(type) {
                try {
                    const response = await this.apiRequest(`/admin/reports/data/${type}`);
                    return response.data;
                } catch (error) {
                    // Fallback demo data
                    const demoData = {
                        user: {
                            totalUsers: 404,
                            newRegistrations: 89,
                            verificationsPending: 3
                        },
                        engagement: {
                            eventParticipation: '78%',
                            articleViews: 12847,
                            questionAnswers: 456
                        },
                        verification: {
                            pending: 3,
                            approved: 248,
                            rejected: 12
                        },
                        content: {
                            totalArticles: 78,
                            totalEvents: 42,
                            totalQuestions: 134
                        },
                        system: {
                            uptime: '99.9%',
                            avgResponseTime: '1.2s',
                            errorRate: '0.1%'
                        },
                        financial: {
                            revenue: '$12,450',
                            expenses: '$8,230',
                            profit: '$4,220'
                        }
                    };
                    return demoData[type] || {};
                }
            }

            // Dashboard Action Functions
            showQuickActions() {
                const actions = [
                    { icon: 'fas fa-user-plus', text: 'Add New User', action: () => openUserModal('student') },
                    { icon: 'fas fa-calendar-plus', text: 'Create Event', action: () => openEventModal() },
                    { icon: 'fas fa-user-check', text: 'Review Verifications', action: () => this.switchView('verifications') },
                    { icon: 'fas fa-bullhorn', text: 'Send Announcement', action: () => this.showSuccess('Announcement system will be implemented') },
                    { icon: 'fas fa-file-alt', text: 'Generate Report', action: () => this.switchView('reports') },
                    { icon: 'fas fa-cog', text: 'System Settings', action: () => this.switchView('settings') }
                ];

                const actionsList = actions.map(action =>
                    `<div style="padding: 15px 20px; border-bottom: 1px solid var(--gray-200); cursor: pointer; display: flex; align-items: center; gap: 12px; transition: var(--transition);" 
                     onmouseover="this.style.background='var(--gray-50)'" 
                     onmouseout="this.style.background=''" 
                     onclick="(${action.action.toString()})(); this.closest('.modal-overlay').remove()">
                        <i class="${action.icon}" style="color: var(--accent-blue); font-size: 1.1rem; width: 20px;"></i>
                        <span style="font-weight: 500;">${action.text}</span>
                    </div>`
                ).join('');

                const modal = document.createElement('div');
                modal.className = 'modal-overlay';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 350px;">
                        <div class="modal-header">
                            <h2 class="modal-title">
                                <i class="fas fa-bolt" style="margin-right: 8px; color: var(--accent-blue);"></i>
                                Quick Actions
                            </h2>
                            <button class="modal-close" onclick="this.closest('.modal-overlay').remove()">&times;</button>
                        </div>
                        <div style="padding: 0;">${actionsList}</div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            handleActivity(action, activityId) {
                this.showSuccess(`${action} action performed for activity ${activityId}`);
            }

            viewAllActivities() {
                this.showSuccess('View all activities functionality will be implemented');
            }

            scheduleReport() {
                this.showSuccess('Report scheduling functionality will be implemented');
            }

            generateCustomReport() {
                this.showSuccess('Custom report builder will be implemented');
            }

            downloadReportPDF(reportId) {
                this.showSuccess(`Downloading report ${reportId}...`);
            }

            shareReport(reportId) {
                this.showSuccess(`Sharing report ${reportId}...`);
            }

            viewAllReports() {
                this.showSuccess('View all reports functionality will be implemented');
            }

            createArticle() {
                this.showSuccess('Article creation will be implemented');
            }

            moderateQuestions() {
                this.showSuccess('Question moderation panel will be implemented');
            }

            updateAnalytics(timeframe) {
                this.log(`Updating analytics for timeframe: ${timeframe}`);
                this.loadAnalyticsData();
            }

            logout() {
                if (confirm('Are you sure you want to logout?')) {
                    localStorage.removeItem('authToken');
                    localStorage.removeItem('userRole');
                    localStorage.removeItem('userId');

                    if (this.socket) {
                        this.socket.disconnect();
                    }

                    this.log('Admin logged out, redirecting...');
                    window.location.href = './login.html';
                }
            }
        }

        // Global variable to store the admin dashboard instance
        let adminDashboard;

        // Global functions for modal and user management
        function openUserModal(type) {
            const modal = document.getElementById('userModal');
            const title = document.getElementById('userModalTitle');
            const roleSelect = document.getElementById('userRole');

            if (type === 'student') {
                title.textContent = 'Add Student';
                roleSelect.value = 'student';
                adminDashboard.updateUserForm('student');
            } else if (type === 'alumni') {
                title.textContent = 'Add Alumni';
                roleSelect.value = 'alumni';
                adminDashboard.updateUserForm('alumni');
            }

            modal.classList.remove('hidden');
        }

        function openEventModal() {
            const modal = document.getElementById('eventModal');
            modal.classList.remove('hidden');
        }

        function closeModal(modalId) {
            adminDashboard.closeModal(modalId);
        }

        // Initialize admin dashboard when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded, initializing Admin Dashboard...');
            try {
                adminDashboard = new AdminDashboard();
            } catch (error) {
                console.error('Failed to initialize admin dashboard:', error);
                // Show error message to user
                document.body.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; height: 100vh; flex-direction: column; gap: 20px;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 3rem; color: var(--error);"></i>
                        <h2 style="color: var(--gray-900);">Failed to Initialize Dashboard</h2>
                        <p style="color: var(--gray-600);">Please refresh the page or contact support.</p>
                        <button onclick="location.reload()" style="padding: 10px 20px; background: var(--accent-blue); color: white; border: none; border-radius: 6px; cursor: pointer;">Refresh Page</button>
                    </div>
                `;
            }
        });

        // Handle page visibility change for real-time updates
        document.addEventListener('visibilitychange', () => {
            if (adminDashboard && !document.hidden) {
                adminDashboard.refreshCurrentView();
            }
        });

        // Handle online/offline events
        window.addEventListener('online', () => {
            if (adminDashboard) {
                adminDashboard.showSuccess('Connection restored');
                adminDashboard.refreshCurrentView();
            }
        });

        window.addEventListener('offline', () => {
            if (adminDashboard) {
                adminDashboard.showError('Connection lost. Some features may not work.');
            }
        });
    </script>
</body>

</html>
